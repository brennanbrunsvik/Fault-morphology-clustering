
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Supp\_notebook\_Text}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{Supplimentary Notebook}\label{supplimentary-notebook}

This supplimentary Jupyter notebook accompanies the main papers
"Methods" and "Results and Analysis" sections. To facilitate simple
code, it has been slightly reorganized to have one section for each of
Clustering, Fault Surface Construction, Slip Inversion, and Coulomb
Stress. Each of these sections has a subsection for Methods and Results.
This organization scheme is inverted from what is in the main text. To
further facilitate clarity of code, some figures appear in different
places than in the main paper.

This notebook was designed to be simple to use while still giving
control. The majority of code has been placed into seperate files. All
code used for the paper is contained within the combination of these
notebooks.

    First, set up the notebook by importing everything and designating
folders for use.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{c+c1}{\PYZsh{} For loading saved values. }
        \PY{n}{variable\PYZus{}folder} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{stored\PYZus{}variables/}\PY{l+s+s2}{\PYZdq{}}
        \PY{n}{slip\PYZus{}dist\PYZus{}folder} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{slip\PYZus{}dist/}\PY{l+s+s1}{\PYZsq{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{c+c1}{\PYZsh{}Import builtin}
        \PY{k+kn}{import} \PY{n+nn}{os}
        \PY{k+kn}{import} \PY{n+nn}{sys}
        \PY{k+kn}{import} \PY{n+nn}{time}
        \PY{k+kn}{from} \PY{n+nn}{datetime} \PY{k}{import} \PY{n}{datetime}\PY{p}{,} \PY{n}{date}\PY{p}{,} \PY{n}{time}
        \PY{k+kn}{import} \PY{n+nn}{copy}
        \PY{k+kn}{import} \PY{n+nn}{json}
        
        \PY{c+c1}{\PYZsh{}sci and num py}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{optimize} \PY{k}{as} \PY{n+nn}{optimize}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{optimize} \PY{k}{import} \PY{n}{least\PYZus{}squares}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{interpolate} \PY{k}{import} \PY{n}{Rbf}
        \PY{k+kn}{from} \PY{n+nn}{scipy} \PY{k}{import} \PY{n}{interpolate}
        \PY{k+kn}{import} \PY{n+nn}{scipy}
        \PY{k+kn}{import} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{io} \PY{k}{as} \PY{n+nn}{sio}
        \PY{k+kn}{from} \PY{n+nn}{numpy}\PY{n+nn}{.}\PY{n+nn}{linalg} \PY{k}{import} \PY{n}{norm}
        \PY{k+kn}{from} \PY{n+nn}{numpy}\PY{n+nn}{.}\PY{n+nn}{linalg} \PY{k}{import} \PY{n}{inv}
        
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        
        \PY{c+c1}{\PYZsh{}okada wrapper is crucial}
        \PY{k}{try}\PY{p}{:} \PY{k+kn}{from} \PY{n+nn}{okada\PYZus{}wrapper} \PY{k}{import} \PY{n}{dc3d0wrapper}\PY{p}{,} \PY{n}{dc3dwrapper} 
        \PY{k}{except}\PY{p}{:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Please install the Okada Wrapper module.}\PY{l+s+se}{\PYZbs{}}
        \PY{l+s+s1}{            https://github.com/tbenthompson/okada\PYZus{}wrapper}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
        
        \PY{c+c1}{\PYZsh{} matplotlib}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib} \PY{k}{as} \PY{n+nn}{mpl}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{from} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{patches} \PY{k}{import} \PY{n}{Ellipse}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{patches} \PY{k}{as} \PY{n+nn}{patches}
        \PY{k+kn}{from} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{ticker} \PY{k}{import} \PY{n}{AutoMinorLocator}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{mlab} \PY{k}{as} \PY{n+nn}{mlab}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}
        \PY{k+kn}{from} \PY{n+nn}{mpl\PYZus{}toolkits}\PY{n+nn}{.}\PY{n+nn}{mplot3d} \PY{k}{import} \PY{n}{Axes3D}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{spatial} \PY{k}{import} \PY{n}{ConvexHull}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{path} \PY{k}{as} \PY{n+nn}{mpltPath}
        
        \PY{c+c1}{\PYZsh{} Import plotly related stuff}
        \PY{k+kn}{import} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{plotly} \PY{k}{as} \PY{n+nn}{py}
        \PY{k+kn}{import} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{graph\PYZus{}objs} \PY{k}{as} \PY{n+nn}{go}
        \PY{k+kn}{from} \PY{n+nn}{plotly}\PY{n+nn}{.}\PY{n+nn}{offline} \PY{k}{import} \PY{n}{download\PYZus{}plotlyjs}\PY{p}{,} \PY{n}{init\PYZus{}notebook\PYZus{}mode}\PY{p}{,} \PY{n}{plot}\PY{p}{,} \PY{n}{iplot}
        \PY{n}{init\PYZus{}notebook\PYZus{}mode}\PY{p}{(}\PY{n}{connected}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{spatial} \PY{k}{import} \PY{n}{Delaunay}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{cm} \PY{k}{as} \PY{n+nn}{cm}
        \PY{k+kn}{from} \PY{n+nn}{functools} \PY{k}{import} \PY{n}{reduce}
        
        \PY{c+c1}{\PYZsh{} For clustering}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cluster} \PY{k}{import} \PY{n}{DBSCAN}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{StandardScaler}
        \PY{k+kn}{import} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{mixture}
        \PY{k+kn}{import} \PY{n+nn}{multiprocessing} \PY{c+c1}{\PYZsh{}!\PYZsh{} may not need multiprocessing}
        \PY{k+kn}{import} \PY{n+nn}{sklearn}
        
        \PY{c+c1}{\PYZsh{} pyproj handles UTM projection}
        \PY{k+kn}{import} \PY{n+nn}{pyproj}
\end{Verbatim}


    
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{c+c1}{\PYZsh{} Functions for loading data. }
        \PY{o}{\PYZpc{}}\PY{k}{run} ./Load\PYZus{}Data.ipynb
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{c+c1}{\PYZsh{} Get functions that are used for many mathematical calculations. Open that file for details. }
        \PY{o}{\PYZpc{}}\PY{k}{run} ./Calculation\PYZus{}Functions.ipynb
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{c+c1}{\PYZsh{} Functions for fault splitting }
        \PY{o}{\PYZpc{}}\PY{k}{run} ./Fault\PYZus{}Splitting.ipynb \PYZsh{}!\PYZsh{} remove this
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{c+c1}{\PYZsh{} Get some fundamental functions for making figures. Open that file for details. }
        \PY{o}{\PYZpc{}}\PY{k}{run} ./Figure\PYZus{}Making\PYZus{}Functions.ipynb
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{c+c1}{\PYZsh{} Get clustering info}
        \PY{o}{\PYZpc{}}\PY{k}{run} ./clustering\PYZus{}base\PYZus{}file.ipynb
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{c+c1}{\PYZsh{} Get some stress related stuff}
        \PY{o}{\PYZpc{}}\PY{k}{run} ./stress\PYZus{}base\PYZus{}file.ipynb
\end{Verbatim}


    \section{2.1: Overview of Methods}\label{overview-of-methods}

    The L'Aquila earthquake swarm was particularly well monitored, allowing
for high resolution location inversions of over 50,000 associated
aftershocks throughout 2009 (Valoroso et al., 2013). Using the
aftershock locations, we cluster them into different faults. This allows
us to interpolate for a fault surface that best fits a clustered set of
hypocenters. We distribute cells of the Okada (1985, 1992) model that
are oriented according to the interpolated surface and we calculate
stress as the sum of stresses generated by these cells. GPS coverage of
the mainshock was exceptional with 77 3-component coseismic
displacements available (Serpelloni, Anderlini, and Belardinelli, 2012).
We use this to invert for and compare the best fit slip distribution for
planar faults and for the 3D fault. We calculate ∆CFF that resulted from
these fault models onto \textasciitilde{}4000 aftershocks.

    \section{Clustering (2.2 and 3.1)}\label{clustering-2.2-and-3.1}

    \subsection{2.2: Methods}\label{methods}

    Hypocenters for over 50,000 earthquakes have been relocated for the
L'Aquila earthquake swarm with a magnitude of completion of
\textasciitilde{}0.7 (Valoroso et al., 2013). These events were
initially located with a relatively low accuracy in a 1D velocity model.
They were then relocated to reduce errors using automatic P and S wave
picking together with cross-correlation and double difference algorithms
(Waldhauser and Ellsworth, 2000; Shaff and Waldhauser, 2005; Waldhauser
and Shaff, 2008). The availability of such a large dataset for
earthquake locations allows for high precision analysis of the anatomy
of the fault system.

In order to interpolate a fault surface based on hypocenters, one must
first separate aftershocks into their respective faults. To distinguish
between different faults in the data, we perform clustering on the
hypocenters based on their locations. This presents a challenge because
where faults intersect, hypocenters of different faults can be very
close to each other and clustering algorithms can be blind to this.
Also, aftershock location inaccuracy is inevitably a problem due to
imperfect knowledge of 3D velocities and elastic properties. Thus,
hypocenters tend to erroneously appear between multiple faults, and
which fault these hypocenters belong to is unclear. To mitigate this,
clustering is done in two iterations; first with a spectral method, and
second with the DBSCAN method. Many overviews of clustering algorithms
are available (e.g. Omran, Engelbrecht, and Salman, 2007; Joshi and
Kaur, 2013).

    During the first clustering iteration, we used the spectral clustering
algorithm from Scikit-Learn (Pedregosa et al., 2011). Spectral
clustering is good at distinguishing clusters when data are connected
but the point-distance from the center of the cluster is irrelevant, and
when the clusters are non-convex. This algorithm computes the Gaussian
affinities (the quantitative similarity between points) based on the
distances between points. It then creates a normalized Laplacian matrix
and clusters based on the eigenvectors. See Von Luxburg (2007) for more
details on spectral clustering. We used only the 767 earthquakes with mL
\textgreater{} 2.5 during the first clustering attempt. This helps to
remove small aftershocks that blur the distinction between different
faults. It also makes the memory intensive spectral clustering algorithm
more stable and manageable. This step separated the hypocenters into
three main clusters.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{c+c1}{\PYZsh{} object with info for all hypocenters. }
        \PY{n}{allHypo} \PY{o}{=} \PY{n}{hypoData}\PY{p}{(}\PY{n}{minMag}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        
        \PY{n}{allHypo}\PY{o}{.}\PY{n}{labels}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{allHypo}\PY{o}{.}\PY{n}{mL}\PY{o}{.}\PY{n}{size}\PY{p}{)}
        
        \PY{k}{if} \PY{k+kc}{False}\PY{p}{:}
            \PY{n}{allHypo}\PY{o}{.}\PY{n}{plot3dclusters}\PY{p}{(}\PY{n}{pointSize}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{save}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} Spectral clustering}
        \PY{n}{sp} \PY{o}{=} \PY{n}{spClust}\PY{p}{(}\PY{p}{)}
        \PY{n}{sp}\PY{o}{.}\PY{n}{minMag}\PY{o}{=}\PY{l+m+mf}{2.5}
        \PY{n}{sp}\PY{o}{.}\PY{n}{getHypocenters}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{sp}\PY{o}{.}\PY{n}{assign\PYZus{}labels}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{discretize}\PY{l+s+s2}{\PYZdq{}}
        \PY{n}{sp}\PY{o}{.}\PY{n}{n\PYZus{}init}\PY{o}{=}\PY{l+m+mi}{10}
        \PY{n}{sp}\PY{o}{.}\PY{n}{beta}\PY{o}{=}\PY{l+m+mi}{1}
        \PY{n}{sp}\PY{o}{.}\PY{n}{n\PYZus{}clusters}\PY{o}{=}\PY{l+m+mi}{3} \PY{c+c1}{\PYZsh{} choose this before hand based on the 3 main faults}
        
        \PY{n}{sp}\PY{o}{.}\PY{n}{cluster}\PY{p}{(}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} spectral clustering is completed }
        \PY{c+c1}{\PYZsh{} sp.labels indicates cluster identities}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/home/brennan/anaconda3/lib/python3.6/site-packages/sklearn/cluster/spectral.py:442: UserWarning:

The spectral clustering API has changed. ``fit``now constructs an affinity matrix from data. To use a custom affinity matrix, set ``affinity=precomputed``.


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{k}{if} \PY{k+kc}{True}\PY{p}{:}
             \PY{n}{sp}\PY{o}{.}\PY{n}{plot3dclusters}\PY{p}{(}\PY{n}{pointSize}\PY{o}{=}\PY{l+m+mi}{7}\PY{p}{)}
\end{Verbatim}


    
    
    The second clustering iteration requires a modified data set to enhance
fault like trends. For the cluster containing the mainshock, we found a
least squares distance best fit plane to the cluster. The positions of
all hypocenters was then stretched by a factor of 5 in the direction
normal to the best fit plane. The stretching factor is subjectively
chosen for ideal performance on the mainshock fault. The purpose is that
trends along the fault surface are left alone, but deviations from this
surface are amplified. With planar like trends more pronounced,
clustering algorithms are much more successful at clustering long faults
and keeping them separate from neighboring faults. This also reduces the
problem that some hypocenter groups may lie along the same fault, but
there are so few hypocenters between these groups that clustering
algorithms normally find them as separate clusters. This spatial
modification allows for less computationally expensive clustering
methods to find more success.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{c+c1}{\PYZsh{} Make a best fit plane to the cluster containing the mainshock}
         
         \PY{n}{laqFault} \PY{o}{=} \PY{n}{sp}\PY{o}{.}\PY{n}{labels}\PY{o}{==}\PY{l+m+mi}{0} \PY{c+c1}{\PYZsh{} make bool for hypocenters in the L\PYZsq{}Aquila fault cluster}
         
         \PY{n}{x} \PY{o}{=} \PY{n}{sp}\PY{o}{.}\PY{n}{x}\PY{p}{[}\PY{n}{laqFault}\PY{p}{]}
         \PY{n}{y} \PY{o}{=} \PY{n}{sp}\PY{o}{.}\PY{n}{y}\PY{p}{[}\PY{n}{laqFault}\PY{p}{]}
         \PY{n}{z} \PY{o}{=} \PY{n}{sp}\PY{o}{.}\PY{n}{z}\PY{p}{[}\PY{n}{laqFault}\PY{p}{]}
         \PY{n}{mL} \PY{o}{=} \PY{n}{sp}\PY{o}{.}\PY{n}{mL}\PY{p}{[}\PY{n}{laqFault}\PY{p}{]}
         \PY{n}{strikeHyp} \PY{o}{=} \PY{n}{sp}\PY{o}{.}\PY{n}{st1}\PY{p}{[}\PY{n}{laqFault}\PY{p}{]}
         \PY{n}{dipHyp} \PY{o}{=} \PY{n}{sp}\PY{o}{.}\PY{n}{dp1}\PY{p}{[}\PY{n}{laqFault}\PY{p}{]}
         \PY{n}{strike2Hyp} \PY{o}{=} \PY{n}{sp}\PY{o}{.}\PY{n}{st2}\PY{p}{[}\PY{n}{laqFault}\PY{p}{]}
         \PY{n}{dip2Hyp} \PY{o}{=} \PY{n}{sp}\PY{o}{.}\PY{n}{dp2}\PY{p}{[}\PY{n}{laqFault}\PY{p}{]}
         
         \PY{n}{focalBool}\PY{o}{=}\PY{n}{sp}\PY{o}{.}\PY{n}{st1}\PY{p}{[}\PY{n}{laqFault}\PY{p}{]}\PY{o}{!=}\PY{l+m+mi}{0} \PY{c+c1}{\PYZsh{} bool for where focal mechanisms are available}
         
         
         \PY{n}{splineNodesLine} \PY{o}{=} \PY{l+m+mi}{7}
         
         \PY{c+c1}{\PYZsh{} exclude points over 10km from plane. Do rms fit. }
         \PY{n}{laqPlane} \PY{o}{=} \PY{n}{interp}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{z}\PY{p}{,} 
                        \PY{n}{strikeHyp}\PY{o}{=}\PY{n}{strikeHyp}\PY{p}{,} \PY{n}{dipHyp}\PY{o}{=}\PY{n}{dipHyp}\PY{p}{,} \PY{n}{strike2Hyp}\PY{o}{=}\PY{n}{strike2Hyp}\PY{p}{,} \PY{n}{dip2Hyp}\PY{o}{=}\PY{n}{dip2Hyp}\PY{p}{,}\PY{n}{focalBool}\PY{o}{=}\PY{n}{focalBool}\PY{p}{,}
                        \PY{n}{eps}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{01}\PY{p}{,} \PY{n}{magnitudeWeight}\PY{o}{=}\PY{n}{mL}\PY{p}{,} \PY{n}{minPlaneDist} \PY{o}{=} \PY{l+m+mi}{10000}\PY{p}{,}\PY{n}{exp}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}
                        \PY{n}{splineNodesStrike} \PY{o}{=} \PY{n}{splineNodesLine}\PY{p}{,} \PY{n}{splineNodesDip} \PY{o}{=} \PY{n}{splineNodesLine}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Prepare for second clustering attempt by \PYZdq{}stretching\PYZdq{} hypocenters.}
         \PY{n}{db2} \PY{o}{=} \PY{n}{dbClust}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{}!\PYZsh{} rename db2 to db}
         \PY{n}{db2}\PY{o}{.}\PY{n}{minMag}\PY{o}{=}\PY{l+m+mi}{0} \PY{c+c1}{\PYZsh{} use all earthquakes}
         \PY{n}{db2}\PY{o}{.}\PY{n}{getHypocenters}\PY{p}{(}\PY{p}{)}
         \PY{n}{db2}\PY{o}{.}\PY{n}{geogToMet}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} p is vector of points.}
         \PY{n}{db2}\PY{o}{.}\PY{n}{p} \PY{o}{=} \PY{n}{rotateUniVec}\PY{p}{(}\PY{n}{db2}\PY{o}{.}\PY{n}{p}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{laqPlane}\PY{o}{.}\PY{n}{xC}\PY{p}{,}\PY{n}{laqPlane}\PY{o}{.}\PY{n}{yC}\PY{p}{,} \PY{n}{laqPlane}\PY{o}{.}\PY{n}{zC}\PY{p}{]}\PY{p}{)}\PY{p}{,}
             \PY{n}{laqPlane}\PY{o}{.}\PY{n}{strikeHat}\PY{p}{,} \PY{n}{laqPlane}\PY{o}{.}\PY{n}{dipHat}\PY{p}{,} \PY{n}{laqPlane}\PY{o}{.}\PY{n}{normalHat}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} stretch points away from plane, but not along plane. }
         \PY{n}{db2}\PY{o}{.}\PY{n}{p}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{*}\PY{o}{=}\PY{l+m+mi}{5}
         
         \PY{c+c1}{\PYZsh{} distances from plane in new coordinate system}
         \PY{n}{distEach} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{distFromPlane}\PY{p}{(}\PY{n}{db2}\PY{o}{.}\PY{n}{x}\PY{p}{,} \PY{n}{db2}\PY{o}{.}\PY{n}{y}\PY{p}{,} \PY{n}{db2}\PY{o}{.}\PY{n}{z}\PY{p}{,} 
                                         \PY{n}{laqPlane}\PY{o}{.}\PY{n}{xC}\PY{p}{,} \PY{n}{laqPlane}\PY{o}{.}\PY{n}{yC}\PY{p}{,} \PY{n}{laqPlane}\PY{o}{.}\PY{n}{zC}\PY{p}{,} 
                                         \PY{n}{laqPlane}\PY{o}{.}\PY{n}{normalHat}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{laqPlane}\PY{o}{.}\PY{n}{normalHat}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{laqPlane}\PY{o}{.}\PY{n}{normalHat}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} We get a warning regarding matrix deficiency, but this is not relevant to the aquired results.}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/home/brennan/anaconda3/lib/python3.6/site-packages/scipy/interpolate/fitpack2.py:1119: UserWarning:


The coefficients of the spline returned have been computed as the
minimal norm least-squares solution of a (numerically) rank deficient
system (deficiency=63). If deficiency is large, the results may be
inaccurate. Deficiency may strongly depend on the value of eps.


    \end{Verbatim}

    For the second clustering iteration on the modified hypocenters, we used
DBSCAN (Density-Based Spatial Clustering of Applications with Noise)
(Ester et al., 1996), which is available through Scikit-Learn (Pedregosa
et al., 2011). This works by first finding a sample that has a minimum
number of other samples, MinPts, within a minimum distance, Eps, and
establishes this as a core sample of a cluster. Points that do not
satisfy this MinPts condition but are near another core point are
considered part of the same cluster as the core point, but they are not
themselves core points. Points that are too distant from any formed
clusters and are not surround by ≥MinPts within radius Eps are
considered noise and are excluded from all clusters. We chose Eps=2.3 km
and MinPts=80 samples. The selection of these values is fairly arbitrary
and choosing values that work well in one location may not work well in
other locations. MinDist and Eps were chosen to perform best for the
mainshock cluster with some expense to performance of the other
clusters.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{db2}\PY{o}{.}\PY{n}{eps}\PY{o}{=}\PY{l+m+mf}{2.3} \PY{o}{*} \PY{l+m+mf}{1e3}
         \PY{n}{db2}\PY{o}{.}\PY{n}{min\PYZus{}samples}\PY{o}{=}\PY{l+m+mi}{80}
         \PY{n}{db2}\PY{o}{.}\PY{n}{fitdbscan}\PY{p}{(}\PY{n}{distEach}\PY{p}{)} \PY{c+c1}{\PYZsh{} cluster in modified axis system}
\end{Verbatim}


    \paragraph{Figure S1 (interactive); Figure
2}\label{figure-s1-interactive-figure-2}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{c+c1}{\PYZsh{} Figure S1, from which Figure 2 is derived}
         
         \PY{k}{if} \PY{k+kc}{True}\PY{p}{:}
             \PY{n}{db2}\PY{o}{.}\PY{n}{plot3dclusters}\PY{p}{(}\PY{n}{pointSize}\PY{o}{=}\PY{l+m+mf}{2.5}\PY{p}{,} \PY{n}{save} \PY{o}{=} \PY{k+kc}{False}\PY{p}{,} \PY{n}{lineWidthR}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}10}\PY{p}{)}
\end{Verbatim}


    
    
    \subsection{3.1: Clustering Results}\label{clustering-results}

    The final clusters, the results of DBSCAN, can be seen in Figure 2. The
reader is also referred to an online interactive 3D plot (Figure S1).
Seven clusters were recognized of which some can be visually identified
as major faults. The separation between major faults and scattered
single aftershocks (referred to as noise and rejected by the DBSCAN
algorithm) appears successful. However, sets of faults antithetic to and
intersecting the mainshock cluster contained a high density of
aftershocks, and these were not distinguishable from the main fault
through clustering (Figure 4b). Clustering also failed to separate the
Campotosto fault from a synthetic fault lying between the L'Aquila and
Campotosto faults. This, however, did not affect the mainshocks cluster,
which is the main topic of this study.

    \section{Fault Surface Construction (2.3 and 3.2
)}\label{fault-surface-construction-2.3-and-3.2}

    \subsection{2.3: Methods}\label{methods}

    The hypocenters in the clustered fault which contained the mainshock
were spatially interpolated to make a best fit 3D fault surface. For
this step, the following coordinate system is used: x1' faces along dip
to the southeast, x2' faces up dip, and x3' faces normal to the plane.
The bicubic splines of Scientific Python (Jones et al., 2014) provide an
excellent tool to interpolate the hypocenters. On the plane that best
fits the aftershock locations of the mainshock cluster, we created a 7x7
grid of knots extending from the minimum to the maximum hypocenter
locations in x1' and x2' where all of the cluster is contained within
the knot grid. Knot parameters are inverted so that the surface provides
a least square error distance to the hypocenters.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{c+c1}{\PYZsh{} Create boolean showing which quakes are in L\PYZsq{}Aquila cluster}
         \PY{c+c1}{\PYZsh{} Then create boolean of those for which focal mechanisms are available}
         \PY{n}{booLaqdb} \PY{o}{=} \PY{n}{db2}\PY{o}{.}\PY{n}{labels}\PY{o}{==}\PY{l+m+mi}{0}
         
         \PY{n}{allPoints} \PY{o}{=} \PY{n}{hypoData}\PY{p}{(}\PY{p}{)}
         \PY{n}{allPoints}\PY{o}{.}\PY{n}{minMag} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{allPoints}\PY{o}{.}\PY{n}{getHypocenters}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{x2} \PY{o}{=} \PY{n}{allPoints}\PY{o}{.}\PY{n}{x}\PY{p}{[}\PY{n}{booLaqdb}\PY{p}{]}
         \PY{n}{y2} \PY{o}{=} \PY{n}{allPoints}\PY{o}{.}\PY{n}{y}\PY{p}{[}\PY{n}{booLaqdb}\PY{p}{]}
         \PY{n}{z2} \PY{o}{=} \PY{n}{allPoints}\PY{o}{.}\PY{n}{z}\PY{p}{[}\PY{n}{booLaqdb}\PY{p}{]}
         \PY{n}{st1} \PY{o}{=} \PY{n}{allPoints}\PY{o}{.}\PY{n}{st1}\PY{p}{[}\PY{n}{booLaqdb}\PY{p}{]}
         \PY{n}{st2} \PY{o}{=} \PY{n}{allPoints}\PY{o}{.}\PY{n}{st2}\PY{p}{[}\PY{n}{booLaqdb}\PY{p}{]}
         \PY{n}{dp1} \PY{o}{=} \PY{n}{allPoints}\PY{o}{.}\PY{n}{dp1}\PY{p}{[}\PY{n}{booLaqdb}\PY{p}{]}
         \PY{n}{dp2} \PY{o}{=} \PY{n}{allPoints}\PY{o}{.}\PY{n}{dp2}\PY{p}{[}\PY{n}{booLaqdb}\PY{p}{]}
         \PY{n}{focalbooLaqdb} \PY{o}{=} \PY{p}{(}\PY{n}{allPoints}\PY{o}{.}\PY{n}{st1}\PY{o}{!=}\PY{l+m+mf}{0.}\PY{p}{)}\PY{p}{[}\PY{n}{booLaqdb}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{splineNodesLine} \PY{o}{=} \PY{l+m+mi}{7}
         
         \PY{c+c1}{\PYZsh{} note that surface is object for spline interpolation}
         \PY{c+c1}{\PYZsh{} surf is object for our 3D mainshock model}
         \PY{n}{surface} \PY{o}{=} \PY{n}{interp}\PY{p}{(}\PY{n}{x2}\PY{p}{,} \PY{n}{y2}\PY{p}{,} \PY{n}{z2}\PY{p}{,}
                        \PY{n}{strikeHyp}\PY{o}{=}\PY{n}{st1}\PY{p}{,} \PY{n}{dipHyp}\PY{o}{=}\PY{n}{dp1}\PY{p}{,} \PY{n}{strike2Hyp}\PY{o}{=}\PY{n}{st2}\PY{p}{,} \PY{n}{dip2Hyp}\PY{o}{=}\PY{n}{dp2}\PY{p}{,} \PY{n}{focalBool}\PY{o}{=}\PY{n}{focalBool}\PY{p}{,}
                        \PY{n}{eps}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{01}\PY{p}{,} \PY{n}{minPlaneDist} \PY{o}{=} \PY{l+m+mi}{10000}\PY{p}{,}\PY{n}{exp}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,}
                        \PY{n}{splineNodesStrike} \PY{o}{=} \PY{n}{splineNodesLine}\PY{p}{,} \PY{n}{splineNodesDip} \PY{o}{=} \PY{n}{splineNodesLine}\PY{p}{)}
         
         \PY{n}{surface}\PY{o}{.}\PY{n}{focalAvailable}\PY{o}{=}\PY{n}{focalbooLaqdb}
         
         \PY{c+c1}{\PYZsh{} We get a deficiency warning, but the surface is good. }
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/home/brennan/anaconda3/lib/python3.6/site-packages/scipy/interpolate/fitpack2.py:1119: UserWarning:


The coefficients of the spline returned have been computed as the
minimal norm least-squares solution of a (numerically) rank deficient
system (deficiency=81). If deficiency is large, the results may be
inaccurate. Deficiency may strongly depend on the value of eps.


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{c+c1}{\PYZsh{} Here, I save info from surface object to upload into a mainshock model.}
         \PY{c+c1}{\PYZsh{} It has to be ran now, but is not relevant until the slip distribution inversion.}
         
         \PY{n}{surface}\PY{o}{.}\PY{n}{gridNodesStrike} \PY{o}{=} \PY{l+m+mi}{40}
         \PY{n}{surface}\PY{o}{.}\PY{n}{gridNodesDip} \PY{o}{=} \PY{l+m+mi}{24}
         
         \PY{c+c1}{\PYZsh{}the outermost cell center be inset from the outermost part of surface:}
         \PY{n}{shiftS} \PY{o}{=} \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{amax}\PY{p}{(}\PY{n}{surface}\PY{o}{.}\PY{n}{pS}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{np}\PY{o}{.}\PY{n}{amin}\PY{p}{(}\PY{n}{surface}\PY{o}{.}\PY{n}{pS}\PY{p}{)}\PY{p}{)} \PY{o}{/} \PY{n}{surface}\PY{o}{.}\PY{n}{gridNodesStrike} \PY{o}{*} \PY{o}{.}\PY{l+m+mi}{5}
         \PY{n}{shiftD} \PY{o}{=} \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{amax}\PY{p}{(}\PY{n}{surface}\PY{o}{.}\PY{n}{pD}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{np}\PY{o}{.}\PY{n}{amin}\PY{p}{(}\PY{n}{surface}\PY{o}{.}\PY{n}{pD}\PY{p}{)}\PY{p}{)} \PY{o}{/} \PY{n}{surface}\PY{o}{.}\PY{n}{gridNodesDip} \PY{o}{*} \PY{o}{.}\PY{l+m+mi}{5}
         \PY{c+c1}{\PYZsh{} Generate points on surface}
         \PY{n}{surface}\PY{o}{.}\PY{n}{splineInterp}\PY{p}{(}\PY{n}{cutPoints}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{sEdgeShift} \PY{o}{=} \PY{n}{shiftS}\PY{p}{,} \PY{n}{dEdgeShift} \PY{o}{=} \PY{n}{shiftD}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} lat lon and depth of okada cells}
         \PY{n}{latSurf}\PY{p}{,} \PY{n}{lonSurf} \PY{o}{=} \PY{n}{allPoints}\PY{o}{.}\PY{n}{metToGeog}\PY{p}{(}\PY{n}{surface}\PY{o}{.}\PY{n}{interpX}\PY{p}{,} \PY{n}{surface}\PY{o}{.}\PY{n}{interpY}\PY{p}{)}
         \PY{n}{depthSurf} \PY{o}{=} \PY{n}{surface}\PY{o}{.}\PY{n}{interpZ}
         
         \PY{c+c1}{\PYZsh{} Surface geometry (strike dip, etc.)}
         \PY{n}{surface}\PY{o}{.}\PY{n}{surfaceNormal}\PY{p}{(}\PY{n}{surface}\PY{o}{.}\PY{n}{interpS}\PY{p}{,} \PY{n}{surface}\PY{o}{.}\PY{n}{interpD}\PY{p}{)}
         \PY{n}{stSurf}\PY{p}{,} \PY{n}{dpSurf} \PY{o}{=} \PY{n}{normalToStrikeDip}\PY{p}{(}\PY{n}{surface}\PY{o}{.}\PY{n}{normalAprox}\PY{p}{)}
         \PY{n}{surface}\PY{o}{.}\PY{n}{simpleCellWidths}\PY{p}{(}\PY{p}{)}
         \PY{n}{strikeWidth} \PY{o}{=} \PY{n}{surface}\PY{o}{.}\PY{n}{strikeWidth}
         \PY{n}{dipWidth} \PY{o}{=} \PY{n}{surface}\PY{o}{.}\PY{n}{dipWidth}
         
         \PY{c+c1}{\PYZsh{} 2d position for spline interpolation}
         \PY{n}{interpS} \PY{o}{=} \PY{n}{surface}\PY{o}{.}\PY{n}{interpS}
         \PY{n}{interpD} \PY{o}{=} \PY{n}{surface}\PY{o}{.}\PY{n}{interpD}
         
         \PY{c+c1}{\PYZsh{} I save this as an array and load it later into a different class.}
         \PY{n}{saveArrays}\PY{p}{(}\PY{p}{[}\PY{n}{latSurf}\PY{p}{,} \PY{n}{lonSurf}\PY{p}{,} \PY{n}{depthSurf}\PY{p}{,} \PY{n}{stSurf}\PY{p}{,} \PY{n}{dpSurf}\PY{p}{,} \PY{n}{interpS}\PY{p}{,} \PY{n}{interpD}\PY{p}{,} \PY{n}{strikeWidth}\PY{p}{,} \PY{n}{dipWidth}\PY{p}{]}\PY{p}{,}
                   \PY{n}{fName} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{surfaceArraysCoarse}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{path} \PY{o}{=} \PY{n}{variable\PYZus{}folder}\PY{p}{)}
\end{Verbatim}


    \subsection{3.2: Results}\label{results}

    The 3D fault surface that best fits the clustered hypocenters can be
seen in Figure 3 and Figure 4. The reader is referred to an online
interactive 3D plot (Figure S2). We first describe the surface. At the
south-east of the fault surface, the dip suddenly decreases going from
bottom to top at a depth of about 3 km. The fault surface wavers here as
it interacts with the more complex distribution of hypocenters. At the
north-east of the fault surface, there is also wavering in the surface
where hypocenter availability was low.

    \paragraph{Figure 3}\label{figure-3}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{c+c1}{\PYZsh{} Figure 3}
         
         \PY{n}{surface}\PY{o}{.}\PY{n}{gridNodesStrike} \PY{o}{=} \PY{l+m+mi}{100}
         \PY{n}{surface}\PY{o}{.}\PY{n}{gridNodesDip} \PY{o}{=} \PY{l+m+mi}{100}
         \PY{n}{surface}\PY{o}{.}\PY{n}{splineInterp}\PY{p}{(}\PY{n}{cutPoints}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         
         \PY{n}{matplotlib}\PY{o}{.}\PY{n}{rcParams}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{font.size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{12}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}pS and pD are point (hypocenter) position in coordinate system of (strike, dip, normal)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{p}{(}\PY{n}{surface}\PY{o}{.}\PY{n}{pS}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{amin}\PY{p}{(}\PY{n}{surface}\PY{o}{.}\PY{n}{pS}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{1000}\PY{p}{,} \PY{p}{(}\PY{n}{surface}\PY{o}{.}\PY{n}{pD}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{amin}\PY{p}{(}\PY{n}{surface}\PY{o}{.}\PY{n}{pD}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{1000}\PY{p}{,} 
                     \PY{n}{c} \PY{o}{=} \PY{n}{surface}\PY{o}{.}\PY{n}{pN}\PY{p}{,} \PY{n}{vmin} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mf}{1e3}\PY{p}{,} \PY{n}{vmax} \PY{o}{=} \PY{l+m+mf}{1e3}\PY{p}{,} 
                     \PY{n}{s} \PY{o}{=} \PY{l+m+mi}{10}\PY{p}{,} \PY{n}{linewidths} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{edgecolor} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Aftershock Position}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Strike distance (km)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dip distance (km)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cbar} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
         \PY{n}{cbar}\PY{o}{.}\PY{n}{set\PYZus{}label}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Distance from plane (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}aspect}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{equal}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{)}
         \PY{n}{xmin} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{ymin} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{xmax} \PY{o}{=} \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{amax}\PY{p}{(}\PY{n}{surface}\PY{o}{.}\PY{n}{interpD}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{np}\PY{o}{.}\PY{n}{amin}\PY{p}{(}\PY{n}{surface}\PY{o}{.}\PY{n}{interpD}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{1000}
         \PY{n}{ymax} \PY{o}{=} \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{amax}\PY{p}{(}\PY{n}{surface}\PY{o}{.}\PY{n}{interpS}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{np}\PY{o}{.}\PY{n}{amin}\PY{p}{(}\PY{n}{surface}\PY{o}{.}\PY{n}{interpS}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{1000}
         \PY{n}{imExtent} \PY{o}{=} \PY{p}{(}\PY{n}{ymin}\PY{p}{,} \PY{n}{ymax}\PY{p}{,} \PY{n}{xmin}\PY{p}{,} \PY{n}{xmax}\PY{p}{)}
         
         \PY{n}{z} \PY{o}{=} \PY{n}{surface}\PY{o}{.}\PY{n}{interpN}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{surface}\PY{o}{.}\PY{n}{gridNodesStrike}\PY{p}{,} \PY{n}{surface}\PY{o}{.}\PY{n}{gridNodesDip}\PY{p}{)}\PY{o}{.}\PY{n}{T}
         \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{z}\PY{p}{,} \PY{n}{vmin} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mf}{1e3}\PY{p}{,} \PY{n}{vmax} \PY{o}{=} \PY{l+m+mf}{1e3}\PY{p}{,} 
                    \PY{n}{origin} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{interpolation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bicubic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                   \PY{n}{extent} \PY{o}{=} \PY{n}{imExtent}\PY{p}{,} \PY{n}{aspect} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{equal}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cbar} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
         \PY{n}{cbar}\PY{o}{.}\PY{n}{set\PYZus{}label}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Distance from plane (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Surface Position}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Strike distance (km)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dip distance (km)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/home/brennan/anaconda3/lib/python3.6/site-packages/matplotlib/cbook/deprecation.py:107: MatplotlibDeprecationWarning:

Adding an axes using the same arguments as a previous axes currently reuses the earlier instance.  In a future version, a new instance will always be created and returned.  Meanwhile, this warning can be suppressed, and the future behavior ensured, by passing a unique label to each axes instance.


    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_35_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_35_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{Figure S2 (interactive), Figure
4}\label{figure-s2-interactive-figure-4}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{c+c1}{\PYZsh{} Figure S2, from which Figure 4 is derived}
         \PY{k}{if} \PY{k+kc}{True}\PY{p}{:}
             \PY{n}{surface}\PY{o}{.}\PY{n}{figure3DSurface}\PY{p}{(}\PY{n}{otherx}\PY{o}{=}\PY{n}{db2}\PY{o}{.}\PY{n}{x}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{booLaqdb}\PY{p}{]}\PY{p}{,} \PY{n}{othery}\PY{o}{=}\PY{n}{db2}\PY{o}{.}\PY{n}{y}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{booLaqdb}\PY{p}{]}\PY{p}{,} \PY{n}{otherz}\PY{o}{=}\PY{n}{db2}\PY{o}{.}\PY{n}{z}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{booLaqdb}\PY{p}{]}\PY{p}{,}
                                   \PY{n}{save} \PY{o}{=} \PY{k+kc}{False}\PY{p}{,} \PY{n}{pointSize}\PY{o}{=}\PY{l+m+mf}{2.1}\PY{p}{,} \PY{n}{pLineWidthR} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


    
    
    We note specifically two locations of the surface where issues in the
interpolation might have arose; (i) at the north-west edge of the fault
where there were few aftershocks for interpolation, visible in Figure 3,
and (ii) near the south-east edge of the fault where there were
conjugate faults intersect this main fault, visible in Figure 4b.

Regarding problem (i), because the clustering did not distinguish
between some conjugate planes that were closely connected to the
mainshock plane, the surface interpolation is slightly shifted by these
conjugate fault hypocenters (Figure 4b). Because the hypocenters were
widely distributed near the fault in the direction normal to the fault
(the aftershocks deviate from the 3D surface by an average magnitude of
\textasciitilde{}400 m), small variation in the fault surface does not
conflict with the hypocenter distribution. It is likely thus not a
problem that the surface is shifted slightly in this location.

Regarding problem (ii), though the splines were inverted on a
homogeneous grid, the hypocenter distribution is highly heterogeneous.
Particularly at the north-west of the splines, interpolation was done
where few hypocenters were available. The splines in this location are
thus underconstrained. This might suggest to eliminate the surface where
there was not enough data to have confidence in the surface
interpolation, for instance through a convex hull. However, it should
not be necessary to remove this section of the surface in part because
if there was no slip here, the GPS slip inversion should and does find
minimal slip here, and stress results will thus be unaffected. It is
also best to maintain consistency between different slip inversion
techniques for easy comparison; that is to keep the slip distribution of
each model rectangular. For these reasons, these problems do not appear
to produce meaningful errors and the surface is not truncated.

We compared the focal mechanism planes to the orientation of the fault
model. This comparison is quantified as the angle between the normal
vector at the fault surface and the normal vector for the aftershock
focal mechanisms (Figure 5). A spatial pattern for agreement or
disagreement between the focal mechanisms and fault surface does not
appear to exist (Figure 5a), suggesting that disagreement is primarily
from focal mechanism inversion error or from aftershocks truly rupturing
at angles that are not the same as our inverted fault surface.

For both our 3D fault and for the planar jointly inverted model (Cirella
et al., 2012), there are two peaks of alignment angles at about 20° and
90° which correspond to the fault and conjugate planes of the focal
mechanisms, respectively (Figure 5b). Agreement improves when the energy
associated to each event (\textasciitilde{}10M) is used as a weight,
suggesting that larger earthquakes are more closely aligned with the
surface, or that the focal mechanisms of smaller events is less well
identified, or both.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{c+c1}{\PYZsh{} Make copy of old surface object so it doesn\PYZsq{}t get broken}
         \PY{c+c1}{\PYZsh{} use it for comparing focal mechanisms. One for our surface + one for Cirella et al. (2012)}
         
         \PY{c+c1}{\PYZsh{} Compare focal to a the planar fault plane of Cirella}
         \PY{n}{planeVsSurface} \PY{o}{=} \PY{n}{copy}\PY{o}{.}\PY{n}{deepcopy}\PY{p}{(}\PY{n}{surface}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} input strike, dip, rake, get normals, use these for comparison}
         \PY{n}{altSurfaceNormal}\PY{p}{,} \PY{n}{\PYZus{}\PYZus{}}\PY{o}{=}\PY{n}{faultUnitVectors}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{2.32128791}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                          \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.9424778}\PY{p}{]}\PY{p}{)}\PY{p}{,} 
                          \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
                         \PY{p}{)}
         \PY{n}{planeVsSurface}\PY{o}{.}\PY{n}{compareFocal}\PY{p}{(}\PY{n}{altSurfaceNormal}\PY{o}{=}\PY{n}{altSurfaceNormal}\PY{p}{)}
         
         
         
         \PY{c+c1}{\PYZsh{} Compare focal to our 3D surface}
         \PY{n}{unmodified} \PY{o}{=} \PY{n}{copy}\PY{o}{.}\PY{n}{deepcopy}\PY{p}{(}\PY{n}{surface}\PY{p}{)}
         \PY{n}{unmodified}\PY{o}{.}\PY{n}{compareFocal}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} the dot products has been completed.}
         
         \PY{c+c1}{\PYZsh{} create weights for Figure 5}
         \PY{n}{mag} \PY{o}{=} \PY{n}{db2}\PY{o}{.}\PY{n}{mL}\PY{p}{[}\PY{n}{db2}\PY{o}{.}\PY{n}{labels}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{n}{unmodified}\PY{o}{.}\PY{n}{focalAvailable}\PY{p}{]}
         \PY{n}{weights} \PY{o}{=} \PY{l+m+mi}{10} \PY{o}{*}\PY{o}{*} \PY{n}{mag} 
         \PY{n}{bN} \PY{o}{=} \PY{n}{weights}\PY{o}{!=}\PY{n}{np}\PY{o}{.}\PY{n}{amax}\PY{p}{(}\PY{n}{weights}\PY{p}{)}  \PY{c+c1}{\PYZsh{} Boolean which excludes mainshock because it otherwise has too much weight}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(1708, 3)
(1708, 3)

    \end{Verbatim}

    \paragraph{Figure 5a}\label{figure-5a}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{c+c1}{\PYZsh{} Figure 5a}
         
         \PY{n}{boo} \PY{o}{=} \PY{n}{unmodified}\PY{o}{.}\PY{n}{focalAvailable}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}aspect}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{equal}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{x} \PY{o}{=} \PY{p}{(}\PY{n}{unmodified}\PY{o}{.}\PY{n}{pS}\PY{p}{[}\PY{n}{boo}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{amin}\PY{p}{(}\PY{n}{unmodified}\PY{o}{.}\PY{n}{pS}\PY{p}{)} \PY{p}{)}\PY{o}{/}\PY{l+m+mi}{1000}
         \PY{n}{y} \PY{o}{=} \PY{p}{(}\PY{n}{unmodified}\PY{o}{.}\PY{n}{pD}\PY{p}{[}\PY{n}{boo}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{amin}\PY{p}{(}\PY{n}{unmodified}\PY{o}{.}\PY{n}{pD}\PY{p}{)} \PY{p}{)}\PY{o}{/}\PY{l+m+mi}{1000}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{c}\PY{o}{=}\PY{n}{unmodified}\PY{o}{.}\PY{n}{thetaLeast}\PY{o}{*}\PY{l+m+mi}{180}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{,}
                 \PY{n}{vmin} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{vmax} \PY{o}{=} \PY{l+m+mi}{90}\PY{p}{,} \PY{n}{linewidths}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{edgecolors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                    \PY{n}{s} \PY{o}{=} \PY{l+m+mi}{15}\PY{p}{)}\PY{c+c1}{\PYZsh{}3**mag)}
         \PY{n}{cbar} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
         \PY{n}{cbar}\PY{o}{.}\PY{n}{set\PYZus{}label}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Angle \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{degree\PYZdl{} from 3D surface}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Strike distance (km)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dip distance (km)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Orientation Mismatch}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_41_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{Figure 5b}\label{figure-5b}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{c+c1}{\PYZsh{}Figure 5b}
         
         \PY{n}{matplotlib}\PY{o}{.}\PY{n}{rcParams}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{font.size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{11}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{hist}\PY{p}{(}
             \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{unmodified}\PY{o}{.}\PY{n}{theta1}\PY{p}{[}\PY{n}{bN}\PY{p}{]}\PY{p}{,} \PY{n}{unmodified}\PY{o}{.}\PY{n}{theta2}\PY{p}{[}\PY{n}{bN}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{180}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{,} 
                  \PY{n}{bins} \PY{o}{=} \PY{l+m+mi}{50}\PY{p}{,} \PY{n+nb}{range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{180}\PY{p}{)}\PY{p}{,} \PY{n}{density} \PY{o}{=} \PY{k+kc}{True}
                 \PY{p}{)}
         \PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{planeVsSurface}\PY{o}{.}\PY{n}{theta1}\PY{p}{[}\PY{n}{bN}\PY{p}{]}\PY{p}{,} \PY{n}{planeVsSurface}\PY{o}{.}\PY{n}{theta2}\PY{p}{[}\PY{n}{bN}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{180}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{,} 
                  \PY{n}{bins} \PY{o}{=} \PY{l+m+mi}{50}\PY{p}{,} \PY{n+nb}{range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{180}\PY{p}{)}\PY{p}{,} \PY{n}{density} \PY{o}{=} \PY{k+kc}{True}
                 \PY{p}{)}
         \PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{unmodified}\PY{o}{.}\PY{n}{theta1}\PY{p}{[}\PY{n}{bN}\PY{p}{]}\PY{p}{,} \PY{n}{unmodified}\PY{o}{.}\PY{n}{theta2}\PY{p}{[}\PY{n}{bN}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{180}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{,} 
                  \PY{n}{bins} \PY{o}{=} \PY{l+m+mi}{50}\PY{p}{,} \PY{n+nb}{range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{180}\PY{p}{)}\PY{p}{,} \PY{n}{density}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}
                  \PY{n}{weights}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{weights}\PY{p}{[}\PY{n}{bN}\PY{p}{]}\PY{p}{,} \PY{n}{weights}\PY{p}{[}\PY{n}{bN}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}
                  \PY{p}{)}
         \PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{planeVsSurface}\PY{o}{.}\PY{n}{theta1}\PY{p}{[}\PY{n}{bN}\PY{p}{]}\PY{p}{,} \PY{n}{planeVsSurface}\PY{o}{.}\PY{n}{theta2}\PY{p}{[}\PY{n}{bN}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{180}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{,} 
                  \PY{n}{bins} \PY{o}{=} \PY{l+m+mi}{50}\PY{p}{,} \PY{n+nb}{range}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{180}\PY{p}{)}\PY{p}{,} \PY{n}{density} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,}
                  \PY{n}{weights}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{weights}\PY{p}{[}\PY{n}{bN}\PY{p}{]}\PY{p}{,} \PY{n}{weights}\PY{p}{[}\PY{n}{bN}\PY{p}{]}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}
                 \PY{p}{)}
         
         \PY{n}{rangeTopFig} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{o}{.}\PY{l+m+mi}{013}\PY{p}{)}
         \PY{n}{rangeBotFit} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{o}{.}\PY{l+m+mi}{03}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:}
             \PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{n}{rangeTopFig}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:}
             \PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{n}{rangeBotFit}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:} 
             \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:}
                 \PY{n}{axs}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{n}{j}\PY{p}{]}\PY{o}{.}\PY{n}{tick\PYZus{}params}\PY{p}{(}\PY{n}{labelleft}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)} 
         
         \PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{3D Model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Planar Model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:}
             \PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Angle}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             
         \PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mechanisms, Unweighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mechanisms, Weighted \PYZdl{}M\PYZca{}}\PY{l+s+si}{\PYZob{}10\PYZcb{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{axs}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{axs}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                 \PY{n}{axs}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{n}{j}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}:.1f\PYZcb{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{degree\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{get\PYZus{}xticks}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{n}{pad} \PY{o}{=} \PY{l+m+mf}{1.3}\PY{p}{)}
         \PY{n}{fig}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Angle from Focal Mechanism to Mainshock Model}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{x\PYZhy{}large}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{l+m+mf}{1.05}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_43_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{Slip Inversion (2.4 and 3.3)}\label{slip-inversion-2.4-and-3.3}

    \subsection{2.4: Methods}\label{methods}

    We invert for a single planar fault with homogenous slip, a planar fault
with heterogeneous slip, and for the slip distribution on the 3D fault
surface that we found. In each case, the inversion is done by matching
the modelled displacements to the displacements measured by GPS. GPS
data includes 77 3-component GPS stations, both survey and continuous
(Serpelloni, Anderlini, and Belardinelli, 2012). Ground displacement was
modelled using homogeneous half-space cells (Okada, 1985; 1982) with the
original fortran code implemented as a Python wrapper (Thompson, 2017).
We use a Poissonian medium with the Lamé parameters equal to 26 GPa as
in Serpelloni, Anderlini, and Belardinelli (2012; see Di Luzio et al.
2009 for crustal model).

    \subsubsection{Invert for mainshock model with homogenous
slip}\label{invert-for-mainshock-model-with-homogenous-slip}

    Before starting the inversion, I test displacement and GPS station
errors using a known fault model from Serpelloni et al. (2012). It
appears to work, so I proceed onward.

We invert for a planar fault with a homogenous slip distribution in
order to obtain a fault planes location and orientation. This location
and orientation is used for our planar fault with heterogeneous slip
distribution. For the homogenous slip distribution inversion, we attempt
to find the global minimum of the weighted residual sum of squares,
\(WRSS\), between the observed,\(d_o\), and modelled, \(d_m\),
displacements where
\(WRSS = \left( d_{o}−d_{m} \right)^{T}\cdot cov^{−1} \cdot \left( d_{o}−d_{m} \right)\)
and \(cov\) is the covariance matrix of the GPS measurements. We use the
Basin-Hopping minimization algorithm from Scientific Python to find a
global minimum of \(WRSS\) for the non-linear problem (Jones et al.,
2014). The parameters were simultaneously inverted; latitude, longitude,
depth (positions are for the center of the fault), strike, dip, rake,
slip, length in strike direction, and width in dip direction.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{c+c1}{\PYZsh{} Try values from Serpelloni et al. (2012) to see if our calculations work. }
         \PY{c+c1}{\PYZsh{} Within some range of error with varying geographic projects etc., our calculations seem to work.}
         
         \PY{n}{ser} \PY{o}{=} \PY{n}{inversionHom}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Serpelloni}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{s homogenously inverted parameters.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{n}{ser}\PY{o}{.}\PY{n}{s} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{129.4} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{/} \PY{l+m+mi}{180}\PY{p}{]}\PY{p}{)}
         \PY{n}{ser}\PY{o}{.}\PY{n}{d} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{50.5} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{/} \PY{l+m+mi}{180}\PY{p}{]}\PY{p}{)}
         \PY{n}{ser}\PY{o}{.}\PY{n}{r} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{105.0} \PY{o}{*} \PY{n}{np}\PY{o}{.}\PY{n}{pi} \PY{o}{/} \PY{l+m+mf}{180.}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{ser}\PY{o}{.}\PY{n}{lon} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{13.387}\PY{p}{]}\PY{p}{)}
         \PY{n}{ser}\PY{o}{.}\PY{n}{lat} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{42.285}\PY{p}{]}\PY{p}{)}
         \PY{n}{ser}\PY{o}{.}\PY{n}{slip} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{o}{.}\PY{l+m+mi}{602}\PY{p}{]}\PY{p}{)} 
         
         \PY{n}{ser}\PY{o}{.}\PY{n}{strikeLength} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{13900}\PY{p}{]}\PY{p}{)}
         \PY{n}{ser}\PY{o}{.}\PY{n}{dipLength} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{16000}\PY{p}{]}\PY{p}{)} 
         \PY{n}{ser}\PY{o}{.}\PY{n}{depth} \PY{o}{=} \PY{o}{\PYZhy{}} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{13200}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{ser}\PY{o}{.}\PY{n}{strikeRects} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
         \PY{n}{ser}\PY{o}{.}\PY{n}{verticalRects} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{ser}\PY{o}{.}\PY{n}{centerOrigin}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bottomCenter}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{ser}\PY{o}{.}\PY{n}{slipComponents}\PY{p}{(}\PY{p}{)}
         \PY{n}{ser}\PY{o}{.}\PY{n}{makeLists}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{} make list of these parameters for later code. }
         
         \PY{n}{ser}\PY{o}{.}\PY{n}{testCS}\PY{p}{(}\PY{p}{)}
         \PY{n}{ser}\PY{o}{.}\PY{n}{plotErrors}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_49_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
rms residual for dx, dy, dz =  (0.0055110769041538405, 0.005089894411323688, 0.010163383989401767)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{c+c1}{\PYZsh{} Starting point for inverting fault with homogenous slip distribution}
         \PY{c+c1}{\PYZsh{} Starting parameters should be quite close to final ones, as the problem is }
         \PY{c+c1}{\PYZsh{}     non linear and difficult. This isn\PYZsq{}t an important point of our paper. }
         
         \PY{n}{Strike}                   \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[} \PY{l+m+mf}{2.259223}\PY{p}{]}\PY{p}{)}
         \PY{n}{Dip}                      \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[} \PY{l+m+mf}{0.890402}\PY{p}{]}\PY{p}{)}
         \PY{n}{Rake}                     \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{1.822806}\PY{p}{]}\PY{p}{)}
         \PY{n}{Lon}                      \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[} \PY{l+m+mf}{13.42772}\PY{p}{]}\PY{p}{)}
         \PY{n}{Lat}                      \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[} \PY{l+m+mf}{42.31982}\PY{p}{]}\PY{p}{)}
         \PY{n}{Depth}                    \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{7072.831}\PY{p}{]}\PY{p}{)}
         \PY{n}{Slip}                     \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[} \PY{l+m+mf}{0.601985}\PY{p}{]}\PY{p}{)}
         \PY{n}{Strikeslip}               \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.150105}\PY{p}{]}\PY{p}{)}
         \PY{n}{Dipslip}                  \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.582970}\PY{p}{]}\PY{p}{)}
         \PY{n}{Tensile}                  \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[} \PY{l+m+mf}{0.}      \PY{p}{]}\PY{p}{)}
         \PY{n}{Strikelength}             \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[} \PY{l+m+mi}{13842}   \PY{p}{]}\PY{p}{)}
         \PY{n}{Diplength}                \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[} \PY{l+m+mi}{16098}   \PY{p}{]}\PY{p}{)}
         \PY{n}{Strikerectangles}         \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[} \PY{l+m+mi}{1}       \PY{p}{]}\PY{p}{)}
         \PY{n}{Verticalrectangles}       \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[} \PY{l+m+mi}{1}       \PY{p}{]}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} make object for homogenous slip distribution inversion}
         \PY{n}{hom} \PY{o}{=} \PY{n}{inversionHom}\PY{p}{(}\PY{n}{iterations}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{,} \PY{n}{arraySaveName}\PY{o}{=}\PY{n}{variable\PYZus{}folder}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{homogenousTests}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{rescale}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CG}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{hom}\PY{o}{.}\PY{n}{getStartVals}\PY{p}{(}\PY{n}{Lon}\PY{p}{,} \PY{n}{Lat}\PY{p}{,} \PY{n}{Depth}\PY{p}{,} \PY{n}{Strike}\PY{p}{,} \PY{n}{Dip}\PY{p}{,} \PY{n}{Rake}\PY{p}{,} \PY{n}{Slip}\PY{p}{,} 
                    \PY{n}{Strikelength}\PY{p}{,} \PY{n}{Diplength}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{k}{if} \PY{k+kc}{True}\PY{p}{:}
             \PY{n}{hom}\PY{o}{.}\PY{n}{loadResults}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{hom}\PY{o}{.}\PY{n}{iterations} \PY{o}{=} \PY{l+m+mi}{10}
         \PY{k}{if} \PY{k+kc}{False}\PY{p}{:}
             \PY{n}{hom}\PY{o}{.}\PY{n}{runOptimizeBH}\PY{p}{(}\PY{n}{ratioOfEpsilon}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{2}\PY{p}{)}
         
         \PY{k}{if} \PY{k+kc}{False}\PY{p}{:}
             \PY{n}{hom}\PY{o}{.}\PY{n}{saveResults}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n}{hom}\PY{o}{.}\PY{n}{testCS}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{} testCS here really just is used to find displacements at GPS stations}
         \PY{n}{hom}\PY{o}{.}\PY{n}{plotErrors}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_52_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
rms residual for dx, dy, dz =  (0.005240070538395109, 0.0049389359296814735, 0.010751266986358166)

    \end{Verbatim}

    \paragraph{Table 1}\label{table-1}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{c+c1}{\PYZsh{} Table 1}
         \PY{k}{if} \PY{k+kc}{True}\PY{p}{:} 
             \PY{n}{homLabels} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Strike}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dip}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rake}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Lon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Lat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (km)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Slip (cm)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Strike Length (km)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dip Length (km)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
             \PY{n}{homValsTable} \PY{o}{=} \PY{p}{[}
                 \PY{n}{np}\PY{o}{.}\PY{n}{around}\PY{p}{(}\PY{n}{hom}\PY{o}{.}\PY{n}{s}\PY{o}{*}\PY{l+m+mi}{180}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{)}\PY{p}{,} 
                 \PY{n}{np}\PY{o}{.}\PY{n}{around}\PY{p}{(}\PY{n}{hom}\PY{o}{.}\PY{n}{d}\PY{o}{*}\PY{l+m+mi}{180}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{)}\PY{p}{,} 
                 \PY{n}{np}\PY{o}{.}\PY{n}{around}\PY{p}{(}\PY{n}{hom}\PY{o}{.}\PY{n}{r}\PY{o}{*}\PY{l+m+mi}{180}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{p}{)}\PY{p}{,} 
                 \PY{n}{np}\PY{o}{.}\PY{n}{around}\PY{p}{(}\PY{n}{hom}\PY{o}{.}\PY{n}{lon}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,}     
                 \PY{n}{np}\PY{o}{.}\PY{n}{around}\PY{p}{(}\PY{n}{hom}\PY{o}{.}\PY{n}{lat}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,} 
                 \PY{n}{np}\PY{o}{.}\PY{n}{around}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{n}{hom}\PY{o}{.}\PY{n}{depth}\PY{o}{/}\PY{l+m+mi}{1000}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,} 
                 \PY{n}{np}\PY{o}{.}\PY{n}{around}\PY{p}{(}\PY{n}{hom}\PY{o}{.}\PY{n}{slip}\PY{o}{*}\PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}
                 \PY{n}{np}\PY{o}{.}\PY{n}{around}\PY{p}{(}\PY{n}{hom}\PY{o}{.}\PY{n}{strikeLength}\PY{o}{/}\PY{l+m+mi}{1000}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} 
                 \PY{n}{np}\PY{o}{.}\PY{n}{around}\PY{p}{(}\PY{n}{hom}\PY{o}{.}\PY{n}{dipLength}\PY{o}{/}\PY{l+m+mi}{1000}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
                           \PY{p}{]}
         
             \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{thing} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{homValsTable}\PY{p}{)}\PY{p}{:}
                 \PY{n}{homValsTable}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{n}{thing}\PY{p}{)}
         
             \PY{n}{values} \PY{o}{=} \PY{p}{[}\PY{n}{homLabels}\PY{p}{,} \PY{n}{homValsTable}\PY{p}{]}
             \PY{n}{trace} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Table}\PY{p}{(}\PY{n}{cells} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n}{values} \PY{o}{=} \PY{n}{values}\PY{p}{)}\PY{p}{)}
             \PY{n}{data} \PY{o}{=} \PY{p}{[}\PY{n}{trace}\PY{p}{]}
             \PY{n}{iplot}\PY{p}{(}\PY{n}{data}\PY{p}{)}
\end{Verbatim}


    
    
    \subsubsection{Prepare Cirella et al. (2012)
model}\label{prepare-cirella-et-al.-2012-model}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{cir} \PY{o}{=} \PY{n}{bilinearFaultImport}\PY{p}{(}\PY{p}{)}
         \PY{n}{cir}\PY{o}{.}\PY{n}{loadModel}\PY{p}{(}\PY{n}{splineShape}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{9}\PY{p}{)}\PY{p}{)}
         \PY{n}{cir}\PY{o}{.}\PY{n}{shiftKnots}\PY{p}{(}\PY{p}{)}
         \PY{n}{cir}\PY{o}{.}\PY{n}{getMainshockPosition}\PY{p}{(}\PY{p}{)}
         \PY{n}{cir}\PY{o}{.}\PY{n}{spGrid}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{cir}\PY{o}{.}\PY{n}{mechanicalConstants}\PY{p}{(}\PY{p}{)}
         \PY{k}{if} \PY{k+kc}{True}\PY{p}{:}
             \PY{n}{cir}\PY{o}{.}\PY{n}{GPSConstants}\PY{p}{(}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{use GPSConstantsAlternate to use GPS data more similar to what was used in Cirella et al. (2012)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k}{if} \PY{k+kc}{False}\PY{p}{:}
             \PY{n}{cir}\PY{o}{.}\PY{n}{GPSConstantsAlternate}\PY{p}{(}\PY{p}{)}
         \PY{n}{cir}\PY{o}{.}\PY{n}{dummyPointSDR}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{cir}\PY{o}{.}\PY{n}{strikeRects} \PY{o}{=} \PY{l+m+mi}{40} 
         \PY{n}{cir}\PY{o}{.}\PY{n}{verticalRects} \PY{o}{=} \PY{l+m+mi}{24} 
         
         \PY{n}{cir}\PY{o}{.}\PY{n}{makeLists}\PY{p}{(}\PY{p}{)}
         \PY{n}{cir}\PY{o}{.}\PY{n}{geogToMet}\PY{p}{(}\PY{p}{)}
         \PY{n}{cir}\PY{o}{.}\PY{n}{coord2d}\PY{p}{(}\PY{p}{)}
             
         \PY{n}{cir}\PY{o}{.}\PY{n}{spGrid}\PY{p}{(}\PY{p}{)}
         \PY{n}{cir}\PY{o}{.}\PY{n}{testCS}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
use GPSConstantsAlternate to use GPS data more similar to what was used in Cirella et al. (2012)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{c+c1}{\PYZsh{} Figure 6a}
         \PY{n}{cir}\PY{o}{.}\PY{n}{plotErrors}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
rms residual for dx, dy, dz =  (0.006911410885507415, 0.007078389548454798, 0.010611739688529402)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{c+c1}{\PYZsh{} Figure 7a }
         \PY{n}{cir}\PY{o}{.}\PY{n}{spImageVector}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_58_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Heterogeneous flat fault}\label{heterogeneous-flat-fault}

    When inverting for the slip distribution, it is helpful to increase the
size of the fault to allow for slip to gently taper off toward the edges
of the fault. The length of the fault in the strike direction was
extended to 35 km, similar to the length of the inverted 3D fault
surface. The dip length of the fault was left unmodified because the
planes maximum depth (about 12 km) already extends beyond the maximum
observed depth of hypocenters on the fault (about 11 km).

To invert for slip distribution on both the planar and 3D fault models,
the methods are very similar to each other except that the individual
fault cell orientations and positions are dealt with differently
(discussed later). We represent the slip distribution on faults using
bicubic splines (Jones et al., 2014). A grid of nodes is distributed
over the fault with variable slips, and the splines are used to
interpolate for the slip between these nodes. Slip values at the base
and sides of the fault are held at 0. Because the ground surface was
co-seismically ruptured (Boncio et al., 2010; Roberts et al., 2010;
Cinti et al., 2011), slip is allowed to vary at the top of the fault.
Uniformly sized Okada (1985, 1992) type fault patches are distributed
over the fault, and the slip on these patches is calculated based on the
slip value of the splines in the centers of the fault patches. There are
9 by 6 spline nodes in the strike and dip direction respectively, while
there are 40 by 24 fault cells.

To prevent an unrealistically sharp slip distribution which overfits the
data, some smoothing function is needed. For the fault models with
variable slip distribution, instead of simply minimizing for \(WRSS\),
we minimize \(WRSS+R\) where \(R\) is a positive scalar that quantifies
the roughness of the slip distribution. \(R\) is defined here as:
\[\beta\Sigma_{i=1}^{2} \int \left( \nabla ^2 u_{i} \right)^{2} dA\]
where \(u_i\) is the slip in the strike slip or dip slip direction, and
\(\beta\) is a smoothing factor that is manually chosen to determine how
important the smoothness of the slip distribution is relative to
minimizing \(WRSS\)(Harris and Segal, 1987; Yabuki and Matsu'ura, 1992;
Serpelloni, Anderlini, and Belardinelli, 2012). The choice of function
to quantitatively represent slip roughness is relatively arbitrary. We
chose \(\beta\)where there is a maximum trade-off between roughness and
\(WRSS\). The choice of \(\beta\) is subjective here, but other methods
can apply smoothing in a more objective way (Yabuki and Matsu'ura, 1992;
Cambiotti et al., 2017). We used the BFGS minimization algorithm (Jones
et al., 2014).

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{c+c1}{\PYZsh{} Multiple iterations with increasing number of nodes.}
         \PY{n}{heter} \PY{o}{=} \PY{n}{inversions}\PY{p}{(}\PY{p}{)}
         \PY{n}{heter}\PY{o}{.}\PY{n}{importHomogenous}\PY{p}{(}\PY{n}{hom}\PY{p}{)} \PY{c+c1}{\PYZsh{} get geometry of previously inverted fault}
         \PY{n}{heter}\PY{o}{.}\PY{n}{getMainshockPosition}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{} project mainshock into a strike\PYZhy{}dip coordinate system for plots}
         
         \PY{c+c1}{\PYZsh{} stretch strike length to accomadate for tapering fault}
         \PY{n}{heter}\PY{o}{.}\PY{n}{strikeLength} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{35e3}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{heter}\PY{o}{.}\PY{n}{mechanicalConstants}\PY{p}{(}\PY{p}{)}
         \PY{n}{heter}\PY{o}{.}\PY{n}{GPSConstants}\PY{p}{(}\PY{p}{)}
         \PY{n}{heter}\PY{o}{.}\PY{n}{dummyPointSDR}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{heter}\PY{o}{.}\PY{n}{strikeRects} \PY{o}{=} \PY{l+m+mi}{40}
         \PY{n}{heter}\PY{o}{.}\PY{n}{verticalRects} \PY{o}{=} \PY{l+m+mi}{24}
         \PY{n}{heter}\PY{o}{.}\PY{n}{setMinMax}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{heter}\PY{o}{.}\PY{n}{makeLists}\PY{p}{(}\PY{p}{)}
         \PY{n}{heter}\PY{o}{.}\PY{n}{geogToMet}\PY{p}{(}\PY{p}{)}
         \PY{n}{heter}\PY{o}{.}\PY{n}{ratio}\PY{o}{=}\PY{l+m+mi}{2}
         
         \PY{n}{heter}\PY{o}{.}\PY{n}{coord2d}\PY{p}{(}\PY{p}{)}
         \PY{n}{heter}\PY{o}{.}\PY{n}{sNodes} \PY{o}{=} \PY{l+m+mi}{9}
         \PY{n}{heter}\PY{o}{.}\PY{n}{dNodes} \PY{o}{=} \PY{l+m+mi}{6}
         \PY{n}{heter}\PY{o}{.}\PY{n}{spGrid}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{heter}\PY{o}{.}\PY{n}{spSlipsInit}\PY{p}{(}\PY{p}{)}
         \PY{n}{heter}\PY{o}{.}\PY{n}{splineToCells}\PY{p}{(}\PY{p}{)}
         \PY{n}{heter}\PY{o}{.}\PY{n}{prepLaplacian}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{c+c1}{\PYZsh{} Load saved results, or run again. }
         \PY{k}{if} \PY{k+kc}{False}\PY{p}{:}
             \PY{n}{heter}\PY{o}{.}\PY{n}{constructLinearArrays}\PY{p}{(}\PY{p}{)}
             
         \PY{n}{heterLinearArrays} \PY{o}{=} \PY{n}{variable\PYZus{}folder}\PY{o}{+}\PY{n}{slip\PYZus{}dist\PYZus{}folder}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{heterLinearArrays}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{k}{if} \PY{k+kc}{False}\PY{p}{:}
             \PY{n}{heter}\PY{o}{.}\PY{n}{saveLinearArrays}\PY{p}{(}\PY{n}{heterLinearArrays}\PY{p}{)}
         
         \PY{k}{if} \PY{k+kc}{True}\PY{p}{:}
             \PY{n}{heter}\PY{o}{.}\PY{n}{loadLinearArrays}\PY{p}{(}\PY{n}{heterLinearArrays}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{c+c1}{\PYZsh{} I have saved models using these b values. Be very careful about changing anything.}
         \PY{k}{if} \PY{k+kc}{True}\PY{p}{:}
             \PY{n}{iterationsEach} \PY{o}{=} \PY{l+m+mi}{100}
             
             \PY{n}{numOfb} \PY{o}{=} \PY{l+m+mi}{30}
             \PY{n}{ball} \PY{o}{=} \PY{l+m+mf}{1e7} \PY{o}{*} \PY{l+m+mi}{10}\PY{o}{*}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{numOfb}\PY{p}{)} \PY{c+c1}{\PYZsh{} for loading use 1e7 * 10**np.linspace(4, 0, numOfb) with numOfb = 30}
         
             \PY{n}{heterBErr} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{p}{]}\PY{p}{]} \PY{c+c1}{\PYZsh{} for comparing b to error}
         
         
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{ball}\PY{o}{.}\PY{n}{size}\PY{p}{)}\PY{p}{:}
                 \PY{n}{heter}\PY{o}{.}\PY{n}{b} \PY{o}{=} \PY{n}{ball}\PY{p}{[}\PY{n}{i}\PY{p}{]}
         
                 \PY{n}{heter}\PY{o}{.}\PY{n}{saveName} \PY{o}{=} \PY{n}{slip\PYZus{}dist\PYZus{}folder}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{heter\PYZus{}slips\PYZus{}b\PYZus{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}e}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{heter}\PY{o}{.}\PY{n}{b} \PY{c+c1}{\PYZsh{} another folder is appended in class}
         
                 \PY{k}{if} \PY{k+kc}{False}\PY{p}{:}
                     \PY{n}{heter}\PY{o}{.}\PY{n}{tol} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{0024}
                     \PY{n}{heter}\PY{o}{.}\PY{n}{iterations}\PY{o}{=}\PY{n}{iterationsEach}
                     \PY{n}{heter}\PY{o}{.}\PY{n}{runErrHetBFGS}\PY{p}{(}\PY{p}{)}
         
                 \PY{k}{if} \PY{k+kc}{False}\PY{p}{:}
                     \PY{n}{heter}\PY{o}{.}\PY{n}{savesp}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{}8x4, 16x8}
         
                 \PY{k}{if} \PY{k+kc}{True}\PY{p}{:}
                     \PY{n}{heter}\PY{o}{.}\PY{n}{loadsp}\PY{p}{(}\PY{p}{)}
                     
                 \PY{n}{heter}\PY{o}{.}\PY{n}{splineToCells}\PY{p}{(}\PY{p}{)}
                 \PY{n}{heter}\PY{o}{.}\PY{n}{getDisp}\PY{p}{(}\PY{p}{)}
                 \PY{n}{heter}\PY{o}{.}\PY{n}{laplacianGrid}\PY{p}{(}\PY{p}{)}
                 \PY{n}{heter}\PY{o}{.}\PY{n}{getWRSS}\PY{p}{(}\PY{p}{)}
                 \PY{n}{heterBErr}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{heter}\PY{o}{.}\PY{n}{b}\PY{p}{)}\PY{p}{;} \PY{n}{heterBErr}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{heter}\PY{o}{.}\PY{n}{WRSS}\PY{p}{)}\PY{p}{;} \PY{n}{heterBErr}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{heter}\PY{o}{.}\PY{n}{smoothe}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
         \PY{n}{a} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{heterBErr}\PY{p}{)}
         \PY{n}{roughness} \PY{o}{=}\PY{n}{a}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{/}\PY{n}{a}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{1e16} 
         \PY{n}{error} \PY{o}{=} \PY{n}{a}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
         
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{roughness}\PY{p}{,} \PY{n}{error}\PY{p}{)}
         
         \PY{n}{indChoice} \PY{o}{=} \PY{l+m+mi}{16}
         \PY{n}{plt}\PY{o}{.}\PY{n}{annotate}\PY{p}{(}\PY{n}{s} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}e}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{a}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{indChoice}\PY{p}{]}\PY{p}{,} \PY{n}{xy} \PY{o}{=} \PY{p}{(}\PY{n}{roughness}\PY{p}{[}\PY{n}{indChoice}\PY{p}{]}\PY{p}{,} \PY{n}{error}\PY{p}{[}\PY{n}{indChoice}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Roughness}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{WRSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_64_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{c+c1}{\PYZsh{} Load the model with chosen b value}
         \PY{n}{heter}\PY{o}{.}\PY{n}{b} \PY{o}{=} \PY{n}{ball}\PY{p}{[}\PY{n}{indChoice}\PY{p}{]} 
         \PY{n}{heter}\PY{o}{.}\PY{n}{saveName} \PY{o}{=} \PY{n}{slip\PYZus{}dist\PYZus{}folder}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{heter\PYZus{}slips\PYZus{}b\PYZus{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}e}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{heter}\PY{o}{.}\PY{n}{b} \PY{c+c1}{\PYZsh{} another folder is appended in class}
         \PY{n}{heter}\PY{o}{.}\PY{n}{loadsp}\PY{p}{(}\PY{p}{)}
         \PY{n}{heter}\PY{o}{.}\PY{n}{splineToCells}\PY{p}{(}\PY{p}{)}
         \PY{n}{heter}\PY{o}{.}\PY{n}{getDisp}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{c+c1}{\PYZsh{} Figure 6b}
         \PY{n}{heter}\PY{o}{.}\PY{n}{plotErrors}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_66_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
rms residual for dx, dy, dz =  (0.004298554105192727, 0.004569259903053761, 0.009915219620951968)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{c+c1}{\PYZsh{} Figure 7b}
         \PY{n}{heter}\PY{o}{.}\PY{n}{spImageVector}\PY{p}{(}\PY{n}{vmax}\PY{o}{=}\PY{l+m+mf}{1.2}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_67_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{n}{heterF} \PY{o}{=} \PY{n}{copy}\PY{o}{.}\PY{n}{deepcopy}\PY{p}{(}\PY{n}{heter}\PY{p}{)} \PY{c+c1}{\PYZsh{} make a copy of that object so we don\PYZsq{}t mess it up}
\end{Verbatim}


    \subsubsection{Invert slip on surface}\label{invert-slip-on-surface}

    Inversion for slip on the curvy surface requires the additional step of
meshing fault cells in 3D. In the homogenous half-space theory that we
use (Okada, 1985, 1992), fault cells are rectangles. It is thus
impossible to create a seamless mesh of Okada type cells on a surface
that is curved. The mismatch should be insignificant so long as
individual fault cells are small enough and curvature of the fault is
minimal. Alternatively, a newer solution on meshable triangles could be
used (Nikkhoo and Walter, 2015). We choose to use a grid of 40 by 24
cells. Fault cell positions and orientations are found according to the
spatially inverted spline parameters that represent the 3D fault
surface. After the fault cells are arranged and oriented, slip
distribution inversion on the 3D mainshock model is the same as with our
planar model.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n}{surf} \PY{o}{=} \PY{n}{inversionCurved}\PY{p}{(}\PY{n}{fName} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{surfaceArraysCoarse}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{surf}\PY{o}{.}\PY{n}{saveName}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{surface\PYZus{}spline\PYZus{}slips}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{surf}\PY{o}{.}\PY{n}{savePath}\PY{o}{=}\PY{n}{variable\PYZus{}folder}
         
         \PY{n}{surf}\PY{o}{.}\PY{n}{temporarySplineBoundary}\PY{p}{(}\PY{p}{)}
         \PY{n}{surf}\PY{o}{.}\PY{n}{spGrid}\PY{p}{(}\PY{l+m+mi}{9}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{)}
         \PY{n}{surf}\PY{o}{.}\PY{n}{spSlipsInit}\PY{p}{(}\PY{n}{ss}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{122}\PY{p}{,} \PY{n}{ds}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{495}\PY{p}{)} \PY{c+c1}{\PYZsh{} Start with values of homogenous inversion}
         
         \PY{n}{surf}\PY{o}{.}\PY{n}{getMainshockPosition}\PY{p}{(}\PY{p}{)}
         \PY{n}{surf}\PY{o}{.}\PY{n}{makeListInitial}\PY{p}{(}\PY{p}{)}
         \PY{n}{surf}\PY{o}{.}\PY{n}{importShapeSplines}\PY{p}{(}\PY{n}{surface}\PY{p}{)}
         \PY{n}{surf}\PY{o}{.}\PY{n}{prepLaplacian}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
trying to replace getmainshockposition with one from parent class
double Check xLoc and yLoc

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{c+c1}{\PYZsh{} Load saved results, or run again. }
         \PY{k}{if} \PY{k+kc}{False}\PY{p}{:}
             \PY{n}{surf}\PY{o}{.}\PY{n}{constructLinearArrays}\PY{p}{(}\PY{p}{)}
             
         \PY{n}{surfLinearArrays} \PY{o}{=} \PY{n}{variable\PYZus{}folder}\PY{o}{+}\PY{n}{slip\PYZus{}dist\PYZus{}folder}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{surfLinearArrays}\PY{l+s+s1}{\PYZsq{}}
         
         \PY{k}{if} \PY{k+kc}{False}\PY{p}{:}
             \PY{n}{surf}\PY{o}{.}\PY{n}{saveLinearArrays}\PY{p}{(}\PY{n}{surfLinearArrays}\PY{p}{)}
         
         \PY{k}{if} \PY{k+kc}{True}\PY{p}{:}
             \PY{n}{surf}\PY{o}{.}\PY{n}{loadLinearArrays}\PY{p}{(}\PY{n}{surfLinearArrays}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{c+c1}{\PYZsh{} I have saved models using these b values. Be very careful about changing anything.}
         \PY{k}{if} \PY{k+kc}{True}\PY{p}{:}
             \PY{n}{iterationsEach} \PY{o}{=} \PY{l+m+mi}{100}
             
             \PY{n}{numOfb} \PY{o}{=} \PY{l+m+mi}{30}
             \PY{n}{ball} \PY{o}{=} \PY{l+m+mf}{1e7} \PY{o}{*} \PY{l+m+mi}{10}\PY{o}{*}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{numOfb}\PY{p}{)}
             
         
             \PY{n}{surfBErr} \PY{o}{=} \PY{p}{[}\PY{p}{[}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{p}{]}\PY{p}{]} \PY{c+c1}{\PYZsh{} for comparing b to error}
         
         
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{ball}\PY{o}{.}\PY{n}{size}\PY{p}{)}\PY{p}{:}
                 \PY{n}{surf}\PY{o}{.}\PY{n}{b} \PY{o}{=} \PY{n}{ball}\PY{p}{[}\PY{n}{i}\PY{p}{]}
         
                 \PY{n}{surf}\PY{o}{.}\PY{n}{saveName} \PY{o}{=} \PY{n}{slip\PYZus{}dist\PYZus{}folder}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{surf\PYZus{}slips\PYZus{}b\PYZus{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}e}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{surf}\PY{o}{.}\PY{n}{b} \PY{c+c1}{\PYZsh{} another folder is appended in class}
         
                 \PY{k}{if} \PY{k+kc}{False}\PY{p}{:}
                     \PY{n}{surf}\PY{o}{.}\PY{n}{tol} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{0024}
                     \PY{n}{surf}\PY{o}{.}\PY{n}{iterations}\PY{o}{=}\PY{n}{iterationsEach}
                     \PY{n}{surf}\PY{o}{.}\PY{n}{runErrHetBFGS}\PY{p}{(}\PY{p}{)}
         
                 \PY{k}{if} \PY{k+kc}{False}\PY{p}{:}
                     \PY{n}{surf}\PY{o}{.}\PY{n}{savesp}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{}8x4, 16x8}
         
                 \PY{k}{if} \PY{k+kc}{True}\PY{p}{:}
                     \PY{n}{surf}\PY{o}{.}\PY{n}{loadsp}\PY{p}{(}\PY{p}{)}
                     
                 \PY{n}{surf}\PY{o}{.}\PY{n}{splineToCells}\PY{p}{(}\PY{p}{)}
                 \PY{n}{surf}\PY{o}{.}\PY{n}{getDisp}\PY{p}{(}\PY{p}{)}
                 \PY{n}{surf}\PY{o}{.}\PY{n}{laplacianGrid}\PY{p}{(}\PY{p}{)}
                 \PY{n}{surf}\PY{o}{.}\PY{n}{getWRSS}\PY{p}{(}\PY{p}{)}
                 \PY{n}{surfBErr}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{surf}\PY{o}{.}\PY{n}{b}\PY{p}{)}\PY{p}{;} \PY{n}{surfBErr}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{surf}\PY{o}{.}\PY{n}{WRSS}\PY{p}{)}\PY{p}{;} \PY{n}{surfBErr}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{surf}\PY{o}{.}\PY{n}{smoothe}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
         \PY{n}{a} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{surfBErr}\PY{p}{)}
         \PY{n}{roughness} \PY{o}{=}\PY{n}{a}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{/}\PY{n}{a}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{1e16} 
         \PY{n}{error} \PY{o}{=} \PY{n}{a}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
         
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{roughness}\PY{p}{,} \PY{n}{error}\PY{p}{)}
         
         \PY{n}{indChoice} \PY{o}{=} \PY{l+m+mi}{15}
         \PY{n}{plt}\PY{o}{.}\PY{n}{annotate}\PY{p}{(}\PY{n}{s} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}e}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{a}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{indChoice}\PY{p}{]}\PY{p}{,} \PY{n}{xy} \PY{o}{=} \PY{p}{(}\PY{n}{roughness}\PY{p}{[}\PY{n}{indChoice}\PY{p}{]}\PY{p}{,} \PY{n}{error}\PY{p}{[}\PY{n}{indChoice}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Roughness}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{WRSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_74_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{c+c1}{\PYZsh{} Load the model with chosen b value}
         \PY{n}{surf}\PY{o}{.}\PY{n}{b} \PY{o}{=} \PY{n}{ball}\PY{p}{[}\PY{n}{indChoice}\PY{p}{]}
         \PY{n}{surf}\PY{o}{.}\PY{n}{saveName} \PY{o}{=} \PY{n}{slip\PYZus{}dist\PYZus{}folder}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{surf\PYZus{}slips\PYZus{}b\PYZus{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}e}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{surf}\PY{o}{.}\PY{n}{b} \PY{c+c1}{\PYZsh{} another folder is appended in class}
         \PY{n}{surf}\PY{o}{.}\PY{n}{loadsp}\PY{p}{(}\PY{p}{)}
         \PY{n}{surf}\PY{o}{.}\PY{n}{splineToCells}\PY{p}{(}\PY{p}{)}
         \PY{n}{surf}\PY{o}{.}\PY{n}{getDisp}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} \PY{c+c1}{\PYZsh{} Figure 6c}
         \PY{n}{surf}\PY{o}{.}\PY{n}{plotErrors}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_76_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
rms residual for dx, dy, dz =  (0.004356326331050954, 0.005413294190474813, 0.009404581341653718)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{c+c1}{\PYZsh{} Figure 7c}
         \PY{n}{surf}\PY{o}{.}\PY{n}{spImageVector}\PY{p}{(}\PY{n}{vmax}\PY{o}{=}\PY{l+m+mf}{1.2}\PY{p}{,} \PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{15}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_77_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} \PY{n}{surfF} \PY{o}{=} \PY{n}{copy}\PY{o}{.}\PY{n}{deepcopy}\PY{p}{(}\PY{n}{surf}\PY{p}{)} \PY{c+c1}{\PYZsh{} Make copy of object so we don\PYZsq{}t mess it up}
\end{Verbatim}


    \subsection{3.3: Results}\label{results}

    (Note that Figure 6 and 7 are repeated here with parts a-c combined for
easy comparison while these sub-parts were seperated in the methods
section)

    The optimum results for the fault model inversion with a homogenous slip
distribution can be seen in Table 1. For a comparison to other
homogeneous models, see Serpelloni, Anderlini, and Belardinelli (2012)
and references therein. We note that our parameters are similar to those
obtained from other studies.

Misfit between modelled and GPS measured displacements can be seen in
Figure 6 and Table 2. We include the jointly inverted planar model of
Cirella et al (2012). We approximate their model using homogenous
half-spaces (Okada, 1985, 1992). This produces some error, primarily on
stations near the fault, as the joint model was originally inverted
using a 3D mechanical model. The inclusion of strong-motion and DInSar
data also slightly decreases the fit at GPS stations but results in more
realism. The jointly inverted planar model has greater misfit than the
purely GPS inverted models. For the purely GPS based inversions, we find
that our 3D mainshock model fits worse for horizontal data and slightly
better for vertical data compared to our planar model.

    \paragraph{Figure 6}\label{figure-6}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{c+c1}{\PYZsh{} Figure 6}
         
         \PY{k}{if} \PY{k+kc}{True}\PY{p}{:}
             \PY{n}{matplotlib}\PY{o}{.}\PY{n}{rcParams}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{font.size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{12}\PY{p}{\PYZcb{}}\PY{p}{)}
             \PY{n}{mods} \PY{o}{=} \PY{p}{[}\PY{n}{cir}\PY{p}{,} \PY{n}{heterF}\PY{p}{,} \PY{n}{surfF}\PY{p}{]}
             \PY{n}{titles} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Planar Joint}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Planar GPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{3D GPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
             \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{model} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{mods}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}     fig, ax = fig, axs = plt.subplots(4, 2, sharex=True)}
                 \PY{n}{model}\PY{o}{.}\PY{n}{testCS}\PY{p}{(}\PY{p}{)}
                 \PY{n}{model}\PY{o}{.}\PY{n}{plotErrors}\PY{p}{(}\PY{n}{label} \PY{o}{=} \PY{n}{titles}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
rms residual for dx, dy, dz =  (0.006911410885507415, 0.007078389548454798, 0.010611739688529402)

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
rms residual for dx, dy, dz =  (0.004298554115084705, 0.004569259909557656, 0.009915219564246826)

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
rms residual for dx, dy, dz =  (0.004356326302450172, 0.00541329416599594, 0.009404581299779226)

    \end{Verbatim}

    \paragraph{Table 2}\label{table-2}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{c+c1}{\PYZsh{} Table 2}
         \PY{n}{models} \PY{o}{=} \PY{p}{[}\PY{n}{cir}\PY{p}{,} \PY{n}{heterF}\PY{p}{,} \PY{n}{surfF}\PY{p}{]}
         \PY{n}{labels} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Planar Joint}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Planar GPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{3D GPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{errors} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n+nb}{len}\PY{p}{(}\PY{n}{models}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
         \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{mod} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{models}\PY{p}{)}\PY{p}{:}
             \PY{n}{mod}\PY{o}{.}\PY{n}{testCS}\PY{p}{(}\PY{p}{)}
             \PY{n}{xerror}\PY{p}{,} \PY{n}{yerror}\PY{p}{,} \PY{n}{zerror} \PY{o}{=} \PY{n}{rmsResiduals}\PY{p}{(}
                 \PY{n}{mod}\PY{o}{.}\PY{n}{dx}\PY{p}{,} \PY{n}{mod}\PY{o}{.}\PY{n}{dy}\PY{p}{,} \PY{n}{mod}\PY{o}{.}\PY{n}{dz}\PY{p}{,} \PY{n}{mod}\PY{o}{.}\PY{n}{dxMeas}\PY{p}{,} \PY{n}{mod}\PY{o}{.}\PY{n}{dyMeas}\PY{p}{,} \PY{n}{mod}\PY{o}{.}\PY{n}{dzMeas}\PY{p}{)}
             \PY{n}{errors}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{p}{:}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{xerror}\PY{p}{,} \PY{n}{yerror}\PY{p}{,} \PY{n}{zerror}\PY{p}{]}\PY{p}{)}
             
         \PY{k}{if} \PY{k+kc}{True}\PY{p}{:}
             \PY{n}{errorsplot} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{around}\PY{p}{(}\PY{n}{errors}\PY{o}{.}\PY{n}{T}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,} \PY{n}{decimals}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
             \PY{n}{errorsplot}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{labels}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} layout = go.Layout(title=\PYZsq{}Title\PYZsq{})}
             \PY{n}{trace} \PY{o}{=} \PY{n}{go}\PY{o}{.}\PY{n}{Table}\PY{p}{(}
                 \PY{n}{header}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{values}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{East Error (mm)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{North Error (mm)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Vertical Error (mm)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{,}
                 \PY{n}{cells}\PY{o}{=}\PY{n+nb}{dict}\PY{p}{(}\PY{n}{values}\PY{o}{=} \PY{n}{errorsplot} \PY{p}{)} \PY{p}{)}
             \PY{n}{data} \PY{o}{=} \PY{p}{[}\PY{n}{trace}\PY{p}{]} 
             \PY{n}{iplot}\PY{p}{(}\PY{n}{data}\PY{p}{)}
\end{Verbatim}


    
    
    The slip distributions can be seen in Figure 7. Following the
misfit-roughness trade off curve to choose the smoothing constant , our
GPS inversions result in models that are much smoother than the joint
model. All models agree that most of the slip occurs above the
hypocenter and is confined between 5 km north-west and 15 km south-east
of the hypocenter.

    \paragraph{Figure 7}\label{figure-7}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{c+c1}{\PYZsh{} Figure 7}
         
         \PY{n}{matplotlib}\PY{o}{.}\PY{n}{rcParams}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{font.size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{15}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{mods} \PY{o}{=} \PY{p}{[}\PY{n}{cir}\PY{p}{,} \PY{n}{heterF}\PY{p}{,} \PY{n}{surfF}\PY{p}{]}
         \PY{n}{titles} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Planar Joint}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Planar GPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{3D GPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{mod} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{mods}\PY{p}{)}\PY{p}{:}
             \PY{n}{mod}\PY{o}{.}\PY{n}{spImageVector}\PY{p}{(}\PY{n}{title} \PY{o}{=} \PY{n}{titles}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{Coulomb Stress (2.5 and 3.4)}\label{coulomb-stress-2.5-and-3.4}

    \subsection{2.5: Methods}\label{methods}

    To understand the significance of incorporating the faults 3D morphology
into stress calculations, and to better understand earthquake
interaction and the source process for earthquakes and especially the
L'Aquila swarm, we compare the stresses that result from these mainshock
models. We use a dataset with 4006 focal mechanisms (Aldersons et al.,
2009) in order to find the ∆CFF that the mainshock generated. These
focal mechanisms were calculated using FPFIT (USGS Open-File Report No.
85-739) method, re-calculating take-off angles in a 3D velocity model.

Coulomb stress is defined as \(CFF=\tau+\mu \left(\sigma_n+P\right)\)
where \(CFF\) is the Coulomb stress, \(\tau\) is the shear stress across
the fault in the direction of slip, \(\mu\) is the coefficient of
friction across the fault, \(\sigma_n\) is the normal stress on the
fault (we use positive as tension), and \(P\) is the pore pressure.
\(CFF\) can be used for quantitative analysis showing how much the
stress on a fault contributes to rupture. This compares the maximum
sustainable shear stress on a fault to the actual shear stress. Positive
\(CFF\)implies fault failure.

In general, the regional shear stress and normal stress on a fault are
unknown. Thus, \(\Delta CFF\) is normally studied instead:
\[\Delta CFF = \Delta \tau + \mu \left( \Delta \sigma_n + \Delta P \right)\]
In this way, one determines whether new stresses imposed on a fault
promote or inhibit rupture, but it is unknown how close a fault actually
is to rupturing. \(\Delta CFF\)is usually several orders of magnitude
smaller than \(CFF\), but it is regardless an often successful technique
at explaining the distribution of aftershocks.

To find co-seismically generated stress, we first calculate the
displacements at any point resulting from a fault model. Deformation is
used to calculate the strain tensor using
\[\varepsilon_{ij} = \frac{1}{2}\left(   \frac{\partial u_i}{\partial x_j} + \frac{\partial u_j}{\partial x_i}  \right)\],
where \(u\) is displacement. The strain tensor is used to calculate the
stress tensor using
\[\sigma_{ij} = 2 G \varepsilon_{ij} + \lambda tr \left(\varepsilon \right)\],
where the shear modulus \(G = 26\) GPa, and Lamé's first parameter
\(\lambda = 26\) GPa. It is assumed that stress does not change after it
is generated.

It is critical that the rupture mechanism of a fault be known to
calculate \(\Delta CFF\). This is because \(\Delta CFF\) is a function
of the shear stress in the direction of slip, not the total shear
stress. We calculate the unit vector for the direction of slip of the
hanging wall as
\[ \hat{s} = <−cos(s) cos(d) sin(r)+ sin(s) cos(r), sin(s) cos(d) sin(r)+cos(s) cos(r), sin(d) sin(r)> \]
and for the direction normal to the fault (into the hanging wall) as
\[\hat{n} = <sin(d) cos(s), −sin(d) sin(s), cos(d) > \] where \(s\) is
strike, \(d\) is dip, and \(r\) is rake. These functions are for a right
handed coordinate system where x1 is east, x2 is north, and x3 is
vertical.

The traction, \(\Delta\vec{T} = \Delta \sigma \cdot \hat{n}\), was used
to calculate the normal stress ,
\(\Delta \sigma_n = \Delta \vec{T} \cdot \hat{n}\), and the shear
stress, \(\vec{\sigma_s}=\Delta T − \Delta \sigma_n \cdot \hat{n}\). The
shear stress in the direction of slip on a fault is
\(\Delta \tau = \Delta \vec{\sigma_s} \cdot \hat{s}\). The coefficient
of friction across all faults is \(\mu = 0.6\). To account for normal
force change due to pore pressure change from static deformation, the
change in pore pressure is treated as proportional to the volumetric
stress \$ \Delta P = − B \frac{tr\left(\Delta \sigma\right)}{3} \$ where
\(B\) is Skempton's coefficient (Cocco and Rice, 2002; Makhnenko and
Labuz, 2013). This formula appears to be sufficiently accurate while not
introducing new, unknown constants. We assumed \(B=0.45\). Within
reasonable variation, stress results are only minimally sensitive to
\(B\)and \(\mu\). Various sets of constants have been used for the
L'Aquila swarm. For instance, Terakawa et al. (2010) used \(\mu = 0.6\)
and \(B=0.6\) Serpelloni, Anderlini, and Belardinelli (2012) used
\(\mu = 0.75\) and \(B = 0.47\), Walter et al. (2009) used an effective
coefficient of friction \(\mu ‘ = 0.6\) (which takes both \(\mu\)and
\(B\)into account), but had similar results with \(\mu ‘ = 0.4\).

We test ∆CFF on the aftershocks both using the inverted focal mechanisms
(Aldersons et al., 2009) and by assuming that aftershocks ruptured on
Optimally Oriented Planes (OOP). We assume that the OOP orientation is
the same as that of our planar mainshock model. We use this assumption
because we do not know the regional stress which is needed to find the
true OOP. Further, the mainshock should rupture according to the
tectonic stress regime and thus is close to the true OOP. The
orientation of the OOP can be assumed to be independent of ∆CFF because
the regional CFF is far greater than ∆CFF. We also find ∆CFF on a grid
assuming OOP orientation for visualization.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{c+c1}{\PYZsh{} Make grid for visualization}
         
         \PY{n}{xmin} \PY{o}{=} \PY{l+m+mi}{13}
         \PY{n}{xmax} \PY{o}{=} \PY{l+m+mf}{13.9}
         \PY{n}{ymin} \PY{o}{=} \PY{l+m+mf}{42.05}
         \PY{n}{ymax} \PY{o}{=} \PY{l+m+mf}{42.7}
         \PY{n}{aspect} \PY{o}{=} \PY{p}{(}\PY{n}{xmin}\PY{o}{\PYZhy{}}\PY{n}{xmax}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{n}{ymin}\PY{o}{\PYZhy{}}\PY{n}{ymax}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} 2d Mesh values. Can be made 3d by changing zz and nz}
         \PY{n}{nx}\PY{o}{=}\PY{l+m+mi}{50}\PY{p}{;}\PY{n}{ny}\PY{o}{=}\PY{l+m+mi}{50}\PY{p}{;} \PY{n}{nz}\PY{o}{=}\PY{l+m+mi}{1}
         \PY{n}{xx} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{xmin}\PY{p}{,}\PY{n}{xmax}\PY{p}{,}\PY{n}{nx}\PY{p}{)}
         \PY{n}{yy} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{ymin}\PY{p}{,}\PY{n}{ymax}\PY{p}{,}\PY{n}{ny}\PY{p}{)}
         \PY{n}{zz} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{5000}\PY{p}{]}\PY{p}{)}
         \PY{n}{xGrid}\PY{p}{,} \PY{n}{yGrid}\PY{p}{,} \PY{n}{zGrid} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{meshgrid}\PY{p}{(}\PY{n}{xx}\PY{p}{,}\PY{n}{yy}\PY{p}{,}\PY{n}{zz}\PY{p}{)}
         \PY{n}{totalPoints}\PY{o}{=}\PY{n}{nx}\PY{o}{*}\PY{n}{ny}\PY{o}{*}\PY{n}{nz}
         \PY{n}{lonGrid}\PY{o}{=}\PY{n}{xGrid}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{totalPoints}\PY{p}{)}
         \PY{n}{latGrid}\PY{o}{=}\PY{n}{yGrid}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{totalPoints}\PY{p}{)}
         \PY{n}{depthGrid}\PY{o}{=}\PY{n}{zGrid}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{n}{totalPoints}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Find dCS assuming same plane as mainshock at each point}
         \PY{n}{sG} \PY{o}{=} \PY{n}{hom}\PY{o}{.}\PY{n}{s}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{n}{totalPoints}\PY{p}{)}
         \PY{n}{dG} \PY{o}{=} \PY{n}{hom}\PY{o}{.}\PY{n}{d}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{n}{totalPoints}\PY{p}{)}
         \PY{n}{rG} \PY{o}{=} \PY{n}{hom}\PY{o}{.}\PY{n}{r}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{n}{totalPoints}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}50}]:} \PY{c+c1}{\PYZsh{} Load hypocenter info. These are points to be strained, not source quakes. }
         
         \PY{p}{[}\PY{n}{latP}\PY{p}{,} \PY{n}{lonP}\PY{p}{,} \PY{n}{depthP}\PY{p}{,} \PY{n}{mLP}\PY{p}{,} \PY{n}{radP}\PY{p}{,} \PY{n}{ST1P}\PY{p}{,} \PY{n}{DIP1P}\PY{p}{,} \PY{n}{RK1P}\PY{p}{,} \PY{n}{ST2P}\PY{p}{,} \PY{n}{DIP2P}\PY{p}{,} \PY{n}{RK2P}\PY{p}{,} \PY{n}{ttP}\PY{p}{,} \PY{n}{slipP}
             \PY{p}{]} \PY{o}{=} \PY{n}{selectedINGV}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{k+kc}{True}\PY{p}{,} \PY{n}{reRun}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,}\PY{n}{path}\PY{o}{=}\PY{n}{variable\PYZus{}folder}\PY{p}{)}
         
         \PY{n}{s1P}\PY{p}{,} \PY{n}{s2P}\PY{p}{,} \PY{n}{d1P}\PY{p}{,} \PY{n}{d2P}\PY{p}{,} \PY{n}{r1P}\PY{p}{,} \PY{n}{r2P} \PY{o}{=} \PY{n}{sortRupture}\PY{p}{(}\PY{n}{ST1P}\PY{p}{,} \PY{n}{ST2P}\PY{p}{,} \PY{n}{DIP1P}\PY{p}{,} \PY{n}{DIP2P}\PY{p}{,} \PY{n}{RK1P}\PY{p}{,} \PY{n}{RK2P}\PY{p}{,} 
                                                             \PY{l+m+mi}{130}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{pi}\PY{o}{/}\PY{l+m+mi}{180}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}51}]:} \PY{c+c1}{\PYZsh{} Values that don\PYZsq{}t change between mainshock models}
         
         \PY{n}{shearMod} \PY{o}{=} \PY{n}{hom}\PY{o}{.}\PY{n}{shearMod}
         \PY{n}{lambdaLame} \PY{o}{=} \PY{n}{hom}\PY{o}{.}\PY{n}{lambdaLame}
         \PY{n}{coefFrict} \PY{o}{=} \PY{n}{hom}\PY{o}{.}\PY{n}{coefFrict}
         \PY{n}{coefSkempt} \PY{o}{=} \PY{n}{hom}\PY{o}{.}\PY{n}{coefSkempt}
         
         \PY{n}{ruptureTime} \PY{o}{=} \PY{n}{allPoints}\PY{o}{.}\PY{n}{time}\PY{p}{[}\PY{n}{allPoints}\PY{o}{.}\PY{n}{mL}\PY{o}{==}\PY{n}{np}\PY{o}{.}\PY{n}{amax}\PY{p}{(}\PY{n}{allPoints}\PY{o}{.}\PY{n}{mL}\PY{p}{)}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} Put the strained points into a tupple to save space.}
         \PY{n}{constInfo} \PY{o}{=} \PY{p}{(}
             \PY{n}{latP}\PY{p}{,} \PY{n}{lonP}\PY{p}{,} \PY{n}{depthP}\PY{p}{,}
             \PY{n}{latGrid}\PY{p}{,} \PY{n}{lonGrid}\PY{p}{,} \PY{n}{depthGrid}\PY{p}{,}
             
             \PY{n}{s1P}\PY{p}{,} \PY{n}{d1P}\PY{p}{,} \PY{n}{r1P}\PY{p}{,}
             \PY{n}{s2P}\PY{p}{,} \PY{n}{d2P}\PY{p}{,} \PY{n}{r2P}\PY{p}{,}
             \PY{n}{sG}\PY{p}{,} \PY{n}{dG}\PY{p}{,} \PY{n}{rG}\PY{p}{,}
             
             \PY{n}{ruptureTime}\PY{p}{,} \PY{n}{ttP}\PY{p}{,}
             \PY{n}{shearMod}\PY{p}{,} \PY{n}{lambdaLame}\PY{p}{,} \PY{n}{coefFrict}\PY{p}{,} \PY{n}{coefSkempt}\PY{p}{)} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}52}]:} \PY{c+c1}{\PYZsh{} CFF calculations of mainshock models are done through run\PYZus{}dCS\PYZus{}each\PYZus{}plane}
         
         \PY{n}{dCS1Heter}\PY{p}{,} \PY{n}{dCS2Heter}\PY{p}{,} \PY{n}{dCSMHeter}\PY{p}{,} \PY{n}{dCSGHeter} \PY{o}{=} \PY{n}{run\PYZus{}dCS\PYZus{}each\PYZus{}plane}\PY{p}{(}
             \PY{n}{heterF}\PY{p}{,} \PY{n}{constInfo}\PY{p}{,} \PY{n}{fName} \PY{o}{=} \PY{n}{variable\PYZus{}folder}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dcsheter}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{load}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{rerun}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{save}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)} \PY{c+c1}{\PYZsh{} done dec 24}
         
         \PY{n}{dCS1cir}\PY{p}{,} \PY{n}{dCS2cir}\PY{p}{,} \PY{n}{dCSMcir}\PY{p}{,} \PY{n}{dCSGcir} \PY{o}{=} \PY{n}{run\PYZus{}dCS\PYZus{}each\PYZus{}plane}\PY{p}{(}
             \PY{n}{cir}\PY{p}{,} \PY{n}{constInfo}\PY{p}{,} \PY{n}{fName} \PY{o}{=} \PY{n}{variable\PYZus{}folder}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dcscir}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{load}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{rerun}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{save}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         
         \PY{n}{dCS1surf}\PY{p}{,} \PY{n}{dCS2surf}\PY{p}{,} \PY{n}{dCSMsurf}\PY{p}{,} \PY{n}{dCSGsurf} \PY{o}{=} \PY{n}{run\PYZus{}dCS\PYZus{}each\PYZus{}plane}\PY{p}{(}
             \PY{n}{surfF}\PY{p}{,} \PY{n}{constInfo}\PY{p}{,} \PY{n}{fName} \PY{o}{=} \PY{n}{variable\PYZus{}folder}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dcssurf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{load}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{rerun}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{save}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \subsection{3.4: Results}\label{results}

    Figure 8 shows the spatial distribution of modelled ∆CFF. We observe
that the distribution of ∆CFF is more complex closer to the fault, while
each model produces more similar results more distant from the fault. In
other words, ∆CFF is not as sensitive to model parameters at locations
distant from the mainshock. This is also shown in Figure 9. We see that
when events which are part of the L'Aquila fault cluster are excluded
from analysis, there is increased similarity between models regarding
the percent of aftershocks with positive ∆CFF.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{c+c1}{\PYZsh{} Make array that shows us which are aftershocks}
         \PY{c+c1}{\PYZsh{} Used for all CFF analysis}
         \PY{n}{mainshockInd} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{allPoints}\PY{o}{.}\PY{n}{mL}\PY{o}{==}\PY{n}{np}\PY{o}{.}\PY{n}{amax}\PY{p}{(}\PY{n}{allPoints}\PY{o}{.}\PY{n}{mL}\PY{p}{)} \PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{n}{aftershock} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{n}{allPoints}\PY{o}{.}\PY{n}{mL}\PY{o}{.}\PY{n}{size}\PY{p}{,} \PY{n}{dtype} \PY{o}{=} \PY{n+nb}{bool}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{aftershock}\PY{o}{.}\PY{n}{size}\PY{p}{)}\PY{p}{:}
             \PY{k}{if} \PY{n}{i} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{mainshockInd}\PY{p}{:}
                 \PY{n}{aftershock}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{k+kc}{False}
         \PY{n}{aftershockFocal} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logical\PYZus{}and}\PY{p}{(}\PY{n}{aftershock}\PY{p}{,} \PY{n}{allPoints}\PY{o}{.}\PY{n}{st1}\PY{o}{!=}\PY{l+m+mi}{0}\PY{p}{)}
         
         \PY{n}{boo} \PY{o}{=} \PY{n}{db2}\PY{o}{.}\PY{n}{labels}\PY{o}{==}\PY{l+m+mi}{0} \PY{c+c1}{\PYZsh{} this IS part of main cluster. }
         
         \PY{n}{allPoints} \PY{o}{=} \PY{n}{hypoData}\PY{p}{(}\PY{p}{)}
         \PY{n}{allPoints}\PY{o}{.}\PY{n}{minMag} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{allPoints}\PY{o}{.}\PY{n}{getHypocenters}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} x2 = allPoints.x[boo] \PYZsh{} \PYZsh{}!\PYZsh{} I don\PYZsq{}t remember what these are for.}
         \PY{c+c1}{\PYZsh{} y2 = allPoints.y[boo]}
         \PY{c+c1}{\PYZsh{} z2 = allPoints.z[boo]}
         \PY{c+c1}{\PYZsh{} st1 = allPoints.st1[boo]}
         \PY{c+c1}{\PYZsh{} st2 = allPoints.st2[boo]}
         \PY{c+c1}{\PYZsh{} dp1 = allPoints.dp1[boo]}
         \PY{c+c1}{\PYZsh{} dp2 = allPoints.dp2[boo]}
         \PY{n}{focalBool} \PY{o}{=} \PY{p}{(}\PY{n}{allPoints}\PY{o}{.}\PY{n}{st1}\PY{o}{!=}\PY{l+m+mf}{0.}\PY{p}{)}\PY{p}{[}\PY{n}{boo}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} Make boolan arrays which show which hypocenters to consider}
         \PY{n}{includeSurf} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logical\PYZus{}and}\PY{p}{(}
             \PY{o}{\PYZti{}}\PY{n}{boo}\PY{p}{,} \PY{n}{aftershock}\PY{p}{)}\PY{p}{[}\PY{n}{allPoints}\PY{o}{.}\PY{n}{st1}\PY{o}{!=}\PY{l+m+mf}{0.}\PY{p}{]} \PY{c+c1}{\PYZsh{} NOT part of surface, is an aftershock}
         \PY{n}{includeAll} \PY{o}{=} \PY{n}{aftershock}\PY{p}{[}\PY{n}{allPoints}\PY{o}{.}\PY{n}{st1}\PY{o}{!=}\PY{l+m+mf}{0.}\PY{p}{]} \PY{c+c1}{\PYZsh{} subset with focal mechanisms and aftershock}
\end{Verbatim}


    \paragraph{Figure 8}\label{figure-8}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}54}]:} \PY{c+c1}{\PYZsh{} Figure 8}
         
         \PY{c+c1}{\PYZsh{} Make individual scatter and image plots for figure below}
         \PY{k}{def} \PY{n+nf}{dCS\PYZus{}sca\PYZus{}im}\PY{p}{(}\PY{n}{ax}\PY{p}{,} \PY{n}{high}\PY{p}{,} \PY{n}{low}\PY{p}{,} \PY{n}{lat}\PY{p}{,} \PY{n}{lon}\PY{p}{,} \PY{n}{dCS1}\PY{p}{,} \PY{n}{dCS2}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,}
                          \PY{n}{dCSG} \PY{o}{=} \PY{k+kc}{None}\PY{p}{,} \PY{n}{strainers}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{maxIm} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{minIm} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{1}\PY{p}{,}
                       \PY{n}{aspect} \PY{o}{=} \PY{l+m+mi}{4}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{alpha} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{9}\PY{p}{,} \PY{n}{errBarWidth} \PY{o}{=} \PY{l+m+mi}{10000}\PY{p}{)}\PY{p}{:}
             \PY{k}{if} \PY{n}{dCSG} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
                 \PY{n}{im} \PY{o}{=} \PY{n}{ax}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{dCSG}\PY{o}{*}\PY{l+m+mf}{1e\PYZhy{}6}\PY{p}{,} \PY{n}{extent} \PY{o}{=} \PY{p}{(}\PY{n}{xmin}\PY{p}{,} \PY{n}{xmax}\PY{p}{,} \PY{n}{ymin}\PY{p}{,} \PY{n}{ymax}\PY{p}{)}\PY{p}{,} 
                        \PY{n}{origin} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lower}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{interpolation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bilinear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{zorder}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}
                        \PY{n}{cmap} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{seismic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{vmax} \PY{o}{=} \PY{n}{maxIm}\PY{p}{,} \PY{n}{vmin} \PY{o}{=} \PY{n}{minIm}\PY{p}{,} 
                                \PY{n}{aspect} \PY{o}{=} \PY{n}{aspect}\PY{p}{,} 
                                \PY{n}{alpha}\PY{o}{=}\PY{n}{alpha}\PY{p}{)}
                 
                 \PY{n}{barX} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{7}\PY{o}{*}\PY{p}{(}\PY{n}{xmax}\PY{o}{\PYZhy{}}\PY{n}{xmin}\PY{p}{)}\PY{o}{+}\PY{n}{xmin}
                 \PY{n}{barY} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{/}\PY{l+m+mi}{10}\PY{o}{*}\PY{p}{(}\PY{n}{ymax}\PY{o}{\PYZhy{}}\PY{n}{ymin}\PY{p}{)}\PY{o}{+}\PY{n}{ymin}
                 \PY{n}{\PYZus{}\PYZus{}}\PY{p}{,} \PY{n}{lonNew} \PY{o}{=} \PY{n}{xyToLonLat}\PY{p}{(}\PY{n}{barY}\PY{p}{,} \PY{n}{barX}\PY{p}{,} \PY{l+m+mi}{10000}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{)}
                 \PY{n}{dxErrBar} \PY{o}{=} \PY{p}{(}\PY{n}{lonNew}\PY{o}{\PYZhy{}}\PY{n}{barX}\PY{p}{)}\PY{o}{*}\PY{o}{.}\PY{l+m+mi}{5} \PY{c+c1}{\PYZsh{} Because err bar goes both directions}
                 \PY{n}{bar} \PY{o}{=} \PY{n}{ax}\PY{o}{.}\PY{n}{errorbar}\PY{p}{(}\PY{n}{barX}\PY{p}{,} \PY{n}{barY}\PY{p}{,} \PY{n}{xerr} \PY{o}{=} \PY{n}{dxErrBar}\PY{p}{,}
                                  \PY{n}{elinewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{white}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{capsize}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{)}
                 \PY{n}{ax}\PY{o}{.}\PY{n}{text}\PY{p}{(}\PY{n}{barX}\PY{p}{,} \PY{n}{barY}\PY{o}{+}\PY{o}{.}\PY{l+m+mi}{5}\PY{o}{*}\PY{n}{dxErrBar}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{10 km}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{white}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                         \PY{n}{horizontalalignment} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
             \PY{k}{if} \PY{n}{dCS2} \PY{o+ow}{is} \PY{k+kc}{None}\PY{p}{:}
                 \PY{n}{dCS2} \PY{o}{=} \PY{n}{dCS1}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
             
             \PY{n}{color}\PY{p}{,} \PY{n}{legend\PYZus{}markers}\PY{p}{,} \PY{n}{labels} \PY{o}{=} \PY{n}{greenRed}\PY{p}{(}\PY{n}{dCS1}\PY{p}{,} \PY{n}{dCS2}\PY{p}{,} \PY{n}{high}\PY{p}{,} \PY{n}{low}\PY{p}{)}
             
             \PY{n}{scatterP} \PY{o}{=} \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{lon}\PY{p}{,} \PY{n}{lat}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{color}\PY{p}{,} \PY{n}{s} \PY{o}{=} \PY{l+m+mi}{10}\PY{p}{,} \PY{n}{zorder}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
                 \PY{n}{linewidths}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,}\PY{n}{edgecolors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}} \PY{p}{)}
             
             \PY{k}{if} \PY{n}{strainers} \PY{o+ow}{is} \PY{o+ow}{not} \PY{k+kc}{None}\PY{p}{:}
                 \PY{n}{scatterF} \PY{o}{=} \PY{n}{ax}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{lon}\PY{p}{[}\PY{n}{strainers}\PY{p}{]}\PY{p}{,} \PY{n}{lat}\PY{p}{[}\PY{n}{strainers}\PY{p}{]}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{n}{color}\PY{p}{,} \PY{n}{s} \PY{o}{=} \PY{l+m+mi}{500}\PY{p}{,} 
                     \PY{n}{marker} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{*}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{zorder} \PY{o}{=} \PY{l+m+mi}{2}\PY{p}{)}
         
             \PY{k}{return} \PY{n}{im}\PY{p}{,} \PY{n}{scatterP}\PY{p}{,} \PY{n}{bar}
         
         
         \PY{n}{minStress}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{1} \PY{c+c1}{\PYZsh{} MPa, for background stress image}
         \PY{n}{maxStress}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{1}
         
         \PY{c+c1}{\PYZsh{} mainshock plane, plane1+2, grid}
         \PY{n}{plots} \PY{o}{=} \PY{l+m+mi}{3}
         
         \PY{c+c1}{\PYZsh{} Put all stresses into one array for a for loop}
         \PY{n}{dCSCombine} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}
             \PY{p}{[}\PY{n}{dCSMcir}\PY{p}{,} \PY{n}{dCS1cir}\PY{p}{,} \PY{n}{dCS2cir}\PY{p}{,} \PY{n}{dCSGcir}\PY{p}{]}\PY{p}{,} 
             \PY{p}{[}\PY{n}{dCSMHeter}\PY{p}{,} \PY{n}{dCS1Heter}\PY{p}{,} \PY{n}{dCS2Heter}\PY{p}{,} \PY{n}{dCSGHeter}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{n}{dCSMsurf}\PY{p}{,} \PY{n}{dCS1surf}\PY{p}{,} \PY{n}{dCS2surf}\PY{p}{,} \PY{n}{dCSGsurf}\PY{p}{]}
         \PY{p}{]}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Silly way of also putting these booleans in an array}
         \PY{n}{inclusion} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}
             \PY{n}{includeAll}\PY{p}{,}
             \PY{n}{includeAll}\PY{p}{,}
             \PY{n}{includeAll}
         \PY{p}{]}\PY{p}{)}
         
         \PY{n}{fig}\PY{p}{,} \PY{n}{axes} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{nrows}\PY{o}{=}\PY{n}{dCSCombine}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{ncols}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,} \PY{l+m+mi}{24}\PY{p}{)}\PY{p}{)}
         \PY{n}{matplotlib}\PY{o}{.}\PY{n}{rcParams}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{font.size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{12}\PY{p}{\PYZcb{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} These aren\PYZsq{}t relevant but are stuck as part of my code}
         \PY{n}{high} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{n}{low} \PY{o}{=} \PY{l+m+mi}{0}
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{plots}\PY{p}{)}\PY{p}{:}
             \PY{n}{im}\PY{p}{,} \PY{n}{scatter1}\PY{p}{,} \PY{n}{bar1} \PY{o}{=} \PY{n}{dCS\PYZus{}sca\PYZus{}im}\PY{p}{(}\PY{n}{axes}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{high}\PY{p}{,} \PY{n}{low}\PY{p}{,} \PY{n}{latP}\PY{p}{[}\PY{n}{inclusion}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{lonP}\PY{p}{[}\PY{n}{inclusion}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} 
                        \PY{n}{dCSCombine}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{n}{inclusion}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{dCSCombine}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{[}\PY{n}{inclusion}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{dCSCombine}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{]}\PY{p}{,}
                                      \PY{n}{minIm} \PY{o}{=} \PY{n}{minStress}\PY{p}{,} \PY{n}{maxIm} \PY{o}{=} \PY{n}{maxStress}\PY{p}{,} \PY{n}{aspect} \PY{o}{=} \PY{n}{aspect}\PY{p}{)}
             
             \PY{n}{im}\PY{p}{,} \PY{n}{scatter2}\PY{p}{,} \PY{n}{bar2} \PY{o}{=} \PY{n}{dCS\PYZus{}sca\PYZus{}im}\PY{p}{(}\PY{n}{axes}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{high}\PY{p}{,} \PY{n}{low}\PY{p}{,} \PY{n}{latP}\PY{p}{[}\PY{n}{inclusion}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{lonP}\PY{p}{[}\PY{n}{inclusion}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} 
                        \PY{n}{dCSCombine}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{[}\PY{n}{inclusion}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{dCSCombine}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{[}\PY{n}{inclusion}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{dCSCombine}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{]}\PY{p}{,}
                                      \PY{n}{minIm} \PY{o}{=} \PY{n}{minStress}\PY{p}{,} \PY{n}{maxIm} \PY{o}{=} \PY{n}{maxStress}\PY{p}{,} \PY{n}{aspect} \PY{o}{=} \PY{n}{aspect}\PY{p}{)}
             
         \PY{c+c1}{\PYZsh{} Label slip distributions}
         \PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Planar Joint}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Planar GPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{3D GPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{axes}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{axes}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                 \PY{n}{axes}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{n}{j}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}yticklabels}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}:.1f\PYZcb{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{degree\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{get\PYZus{}yticks}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{)}
                 \PY{n}{axes}\PY{p}{[}\PY{n}{i}\PY{p}{,} \PY{n}{j}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}:.1f\PYZcb{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{degree\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{get\PYZus{}xticks}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{} Label planes}
         \PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Using mainshock orientation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{axes}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Using focal mechanisms}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Delta\PYZdl{}CFF From Models}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{885}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Colorbar}
         \PY{n}{widthC} \PY{o}{=} \PY{o}{.}\PY{l+m+mi}{35}
         \PY{n}{tallC} \PY{o}{=} \PY{l+m+mf}{0.01}
         \PY{n}{cbar\PYZus{}ax} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}axes}\PY{p}{(}\PY{p}{[}\PY{o}{.}\PY{l+m+mi}{5} \PY{o}{\PYZhy{}} \PY{o}{.}\PY{l+m+mi}{5} \PY{o}{*} \PY{n}{widthC}\PY{p}{,} 
                                 \PY{o}{.}\PY{l+m+mi}{1} \PY{o}{\PYZhy{}} \PY{o}{.}\PY{l+m+mi}{5} \PY{o}{*} \PY{n}{tallC}\PY{p}{,} 
                                 \PY{n}{widthC}\PY{p}{,} \PY{n}{tallC}\PY{p}{]}\PY{p}{)}
         \PY{n}{cbar} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{im}\PY{p}{,} \PY{n}{cax}\PY{o}{=}\PY{n}{cbar\PYZus{}ax}\PY{p}{,} \PY{n}{orientation} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{horizontal}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cbar}\PY{o}{.}\PY{n}{set\PYZus{}label}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Delta\PYZdl{}CFF (MPa)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cticks} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{minStress}\PY{p}{,} \PY{n}{maxStress}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}
         \PY{n}{cbar}\PY{o}{.}\PY{n}{set\PYZus{}ticks}\PY{p}{(}\PY{n}{cticks}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_100_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    When accounting for all aftershocks with focal mechanisms, the jointly
inverted planar model predicts the most events with positive ∆CFF
(Figure 9). This is true regardless of whether OOP or inverted focal
mechanisms are used for aftershock orientations. Our 3D mainshock model
predicts the least events to have positive ∆CFF on inverted focal
mechanisms, but our planar GPS inverted model finds the least events to
have positive ∆CFF on OOP. For each model, the percent of events with
positive ∆CFF increases when we disclude events which were part of the
L'Aquila fault cluster.

    \paragraph{Figure 9}\label{figure-9}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{c+c1}{\PYZsh{} Figure 9a}
         
         
         \PY{c+c1}{\PYZsh{} First, histogram with all afteshocks}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} Labels to use in bar chart}
         \PY{n}{labelsbar} \PY{o}{=} \PY{p}{(}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Planar}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Joint}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Planar}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{GPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{3D}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{GPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         
         \PY{n}{dCSHist} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}
             \PY{p}{[}\PY{n}{dCS1cir}\PY{p}{,}   \PY{n}{dCS2cir}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{n}{dCS1Heter}\PY{p}{,} \PY{n}{dCS2Heter}\PY{p}{]}\PY{p}{,} 
             \PY{p}{[}\PY{n}{dCS1surf}\PY{p}{,}  \PY{n}{dCS2surf}\PY{p}{]}
         \PY{p}{]}\PY{p}{)}
         
         \PY{n}{dCSMHist} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}
             \PY{p}{[}\PY{n}{dCSMcir}\PY{p}{,}   \PY{n}{dCSMcir}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{n}{dCSMHeter}\PY{p}{,} \PY{n}{dCSMHeter}\PY{p}{]}\PY{p}{,} 
             \PY{p}{[}\PY{n}{dCSMsurf}\PY{p}{,}  \PY{n}{dCSMsurf}\PY{p}{]}
         \PY{p}{]}\PY{p}{)}
         
         \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{fig}\PY{o}{.}\PY{n}{set\PYZus{}size\PYZus{}inches}\PY{p}{(}\PY{l+m+mi}{9}\PY{p}{,} \PY{l+m+mf}{5.5}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Event selection}
         \PY{n}{inclusion} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{outer}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{n}{dCSHist}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{includeAll} \PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{bool}\PY{p}{)}
         
         \PY{n}{points} \PY{o}{=} \PY{n}{dCSHist}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{size}
         \PY{n}{bars} \PY{o}{=} \PY{n}{dCSHist}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} How many aftershocks have 0, 1, or 2 positive cff planes}
         \PY{n}{p0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{bars}\PY{p}{)}
         \PY{n}{p1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{bars}\PY{p}{)}
         \PY{n}{p2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{bars}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{bars}\PY{p}{)}\PY{p}{:}
             \PY{n}{pos} \PY{o}{=} \PY{p}{(}\PY{n}{dCSHist}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{n}{inclusion}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)} \PY{o}{+} \PY{p}{(}\PY{n}{dCSHist}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{n}{inclusion}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
             \PY{n}{p0}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{pos}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{)}
             \PY{n}{p1}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{pos}\PY{o}{==}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{p2}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{pos}\PY{o}{==}\PY{l+m+mi}{2}\PY{p}{)}
             
         \PY{n}{p0} \PY{o}{*}\PY{o}{=}\PY{l+m+mi}{100}\PY{o}{/}\PY{n}{points}
         \PY{n}{p1} \PY{o}{*}\PY{o}{=}\PY{l+m+mi}{100}\PY{o}{/}\PY{n}{points}
         \PY{n}{p2} \PY{o}{*}\PY{o}{=}\PY{l+m+mi}{100}\PY{o}{/}\PY{n}{points}  
         
         \PY{n}{ind} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{bars}\PY{p}{)}
         \PY{n}{width} \PY{o}{=} \PY{l+m+mf}{0.45}
         
         \PY{n}{im2} \PY{o}{=} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{ind}\PY{p}{,} \PY{n}{p2}\PY{p}{,} \PY{n}{width}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{im1} \PY{o}{=} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{ind}\PY{p}{,} \PY{n}{p1}\PY{p}{,} \PY{n}{width}\PY{p}{,} \PY{n}{bottom}\PY{o}{=}\PY{n}{p2}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yellow}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{im0} \PY{o}{=} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{ind}\PY{p}{,} \PY{n}{p0}\PY{p}{,} \PY{n}{width}\PY{p}{,} \PY{n}{bottom} \PY{o}{=} \PY{n}{p2}\PY{o}{+}\PY{n}{p1}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}yticklabels}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}:.0f\PYZcb{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{get\PYZus{}yticks}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{bars}\PY{p}{)}\PY{p}{:}
             \PY{n}{pos} \PY{o}{=} \PY{p}{(}\PY{n}{dCSMHist}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{n}{inclusion}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)} \PY{o}{+} \PY{p}{(}\PY{n}{dCSMHist}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{n}{inclusion}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
             \PY{n}{p0}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{pos}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{)}
             \PY{n}{p1}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{pos}\PY{o}{==}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{p2}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{pos}\PY{o}{==}\PY{l+m+mi}{2}\PY{p}{)}
             
         \PY{n}{p0} \PY{o}{*}\PY{o}{=}\PY{l+m+mi}{100}\PY{o}{/}\PY{n}{points}
         \PY{n}{p1} \PY{o}{*}\PY{o}{=}\PY{l+m+mi}{100}\PY{o}{/}\PY{n}{points}
         \PY{n}{p2} \PY{o}{*}\PY{o}{=}\PY{l+m+mi}{100}\PY{o}{/}\PY{n}{points}
         
         \PY{n}{im2} \PY{o}{=} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{ind}\PY{p}{,} \PY{n}{p2}\PY{p}{,} \PY{n}{width}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{im1} \PY{o}{=} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{ind}\PY{p}{,} \PY{n}{p1}\PY{p}{,} \PY{n}{width}\PY{p}{,} \PY{n}{bottom}\PY{o}{=}\PY{n}{p2}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{im0} \PY{o}{=} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{ind}\PY{p}{,} \PY{n}{p0}\PY{p}{,} \PY{n}{width}\PY{p}{,} \PY{n}{bottom} \PY{o}{=} \PY{n}{p2}\PY{o}{+}\PY{n}{p1}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}yticklabels}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}:.0f\PYZcb{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{get\PYZus{}yticks}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Percent}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{ind}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{ind}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{labelsbar}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{labelsbar}\PY{p}{)}
         
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Using Mainshock Orientation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelpad} \PY{o}{=} \PY{l+m+mi}{10}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Using Focal Mechanism Orientation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelpad} \PY{o}{=} \PY{l+m+mi}{10}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Delta CFF\PYZdl{} from Models on all Aftershocks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{l+m+mf}{1.05}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{n}{pad} \PY{o}{=} \PY{l+m+mf}{1.1}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:}
             \PY{n}{ax}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}yticklabels}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}:.0f\PYZcb{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{get\PYZus{}yticks}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_103_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{c+c1}{\PYZsh{} Figure 9b}
         \PY{c+c1}{\PYZsh{} Histogram distant from surface}
         
         \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{fig}\PY{o}{.}\PY{n}{set\PYZus{}size\PYZus{}inches}\PY{p}{(}\PY{l+m+mi}{9}\PY{p}{,} \PY{l+m+mf}{5.5}\PY{p}{)}
         \PY{n}{matplotlib}\PY{o}{.}\PY{n}{rcParams}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{font.size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{12}\PY{p}{\PYZcb{}}\PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} Focal mechanisms}
         \PY{n}{dCSHist} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}
             \PY{p}{[}\PY{n}{dCS1cir}\PY{p}{,}   \PY{n}{dCS2cir}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{n}{dCS1Heter}\PY{p}{,} \PY{n}{dCS2Heter}\PY{p}{]}\PY{p}{,}\PY{c+c1}{\PYZsh{} Heterogeneous inverted, }
             \PY{p}{[}\PY{n}{dCS1surf}\PY{p}{,}  \PY{n}{dCS2surf}\PY{p}{]}
         \PY{p}{]}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{} Event selection}
         \PY{n}{inclusion} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{outer}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{n}{dCSHist}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{,} \PY{n}{includeSurf}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{bool}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         
         \PY{n}{points} \PY{o}{=} \PY{n}{dCSHist}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{size}
         \PY{n}{bars} \PY{o}{=} \PY{n}{dCSHist}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{n}{p0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{bars}\PY{p}{)}
         \PY{n}{p1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{bars}\PY{p}{)}
         \PY{n}{p2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{bars}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{bars}\PY{p}{)}\PY{p}{:}
             \PY{n}{pos} \PY{o}{=} \PY{p}{(}\PY{n}{dCSHist}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{n}{inclusion}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)} \PY{o}{+} \PY{p}{(}\PY{n}{dCSHist}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{n}{inclusion}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
             \PY{n}{p0}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{pos}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{)}
             \PY{n}{p1}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{pos}\PY{o}{==}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{p2}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{pos}\PY{o}{==}\PY{l+m+mi}{2}\PY{p}{)}
             
         \PY{n}{p0} \PY{o}{*}\PY{o}{=}\PY{l+m+mi}{100}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{includeSurf}\PY{p}{)} 
         \PY{n}{p1} \PY{o}{*}\PY{o}{=}\PY{l+m+mi}{100}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{includeSurf}\PY{p}{)} 
         \PY{n}{p2} \PY{o}{*}\PY{o}{=}\PY{l+m+mi}{100}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{includeSurf}\PY{p}{)} 
         
         \PY{n}{ind} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{bars}\PY{p}{)}
         \PY{n}{width} \PY{o}{=} \PY{l+m+mf}{0.45}
         
         \PY{n}{im2} \PY{o}{=} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{ind}\PY{p}{,} \PY{n}{p2}\PY{p}{,} \PY{n}{width}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{im1} \PY{o}{=} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{ind}\PY{p}{,} \PY{n}{p1}\PY{p}{,} \PY{n}{width}\PY{p}{,} \PY{n}{bottom}\PY{o}{=}\PY{n}{p2}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yellow}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{im0} \PY{o}{=} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{ind}\PY{p}{,} \PY{n}{p0}\PY{p}{,} \PY{n}{width}\PY{p}{,} \PY{n}{bottom} \PY{o}{=} \PY{n}{p2}\PY{o}{+}\PY{n}{p1}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} ax[0].set\PYZus{}ylabel(\PYZsq{}Percent\PYZsq{})}
         \PY{c+c1}{\PYZsh{} plt.title(\PYZsq{}Events with positive Coulomb stress\PYZsq{})}
         
         
         \PY{c+c1}{\PYZsh{} ax[0].set\PYZus{}xticklabels(labelsbar)}
         \PY{c+c1}{\PYZsh{} ax[1].set\PYZus{}xticklabels(labelsbar)}
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{n}{dCSHist} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}
         \PY{c+c1}{\PYZsh{}     [dCSMIM ,   dCSMIM], \PYZsh{} INGV inverted}
         \PY{c+c1}{\PYZsh{}     [dCSMHom,   dCSMHom], \PYZsh{} Homogenous inverted}
             \PY{p}{[}\PY{n}{dCSMcir}\PY{p}{,}   \PY{n}{dCSMcir}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{n}{dCSMHeter}\PY{p}{,} \PY{n}{dCSMHeter}\PY{p}{]}\PY{p}{,}\PY{c+c1}{\PYZsh{} Heterogeneous inverted, }
             \PY{p}{[}\PY{n}{dCSMsurf}\PY{p}{,}  \PY{n}{dCSMsurf}\PY{p}{]}
         \PY{p}{]}\PY{p}{)}
         
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{bars}\PY{p}{)}\PY{p}{:}
             \PY{n}{pos} \PY{o}{=} \PY{p}{(}\PY{n}{dCSHist}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{n}{inclusion}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)} \PY{o}{+} \PY{p}{(}\PY{n}{dCSHist}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{[}\PY{n}{inclusion}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}
             \PY{n}{p0}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{pos}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{)}
             \PY{n}{p1}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{pos}\PY{o}{==}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{p2}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{pos}\PY{o}{==}\PY{l+m+mi}{2}\PY{p}{)}
             
         
         \PY{n}{p0} \PY{o}{*}\PY{o}{=}\PY{l+m+mi}{100}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{includeSurf}\PY{p}{)}
         \PY{n}{p1} \PY{o}{*}\PY{o}{=}\PY{l+m+mi}{100}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{includeSurf}\PY{p}{)}
         \PY{n}{p2} \PY{o}{*}\PY{o}{=}\PY{l+m+mi}{100}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{includeSurf}\PY{p}{)}
         
         \PY{n}{im2} \PY{o}{=} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{ind}\PY{p}{,} \PY{n}{p2}\PY{p}{,} \PY{n}{width}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{im1} \PY{o}{=} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{ind}\PY{p}{,} \PY{n}{p1}\PY{p}{,} \PY{n}{width}\PY{p}{,} \PY{n}{bottom}\PY{o}{=}\PY{n}{p2}\PY{p}{,} \PY{n}{color} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yellow}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{im0} \PY{o}{=} \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{ind}\PY{p}{,} \PY{n}{p0}\PY{p}{,} \PY{n}{width}\PY{p}{,} \PY{n}{bottom} \PY{o}{=} \PY{n}{p2}\PY{o}{+}\PY{n}{p1}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Events}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{ind}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xticks}\PY{p}{(}\PY{n}{ind}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{labelsbar}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{labelsbar}\PY{p}{)}
         
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Using Mainshock Orientation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelpad} \PY{o}{=} \PY{l+m+mi}{10}\PY{p}{)}
         \PY{n}{ax}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Using Focal Mechanism Orientation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{labelpad} \PY{o}{=} \PY{l+m+mi}{10}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Delta CFF\PYZdl{} from Models on Aftershocks in L}\PY{l+s+se}{\PYZbs{}\PYZsq{}}\PY{l+s+s1}{Aquila Mainshock Cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y} \PY{o}{=} \PY{l+m+mf}{1.05}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} textOOP = [\PYZsq{}+ on plane\PYZsq{}, \PYZsq{}\PYZhy{} on plane\PYZsq{}]}
         \PY{c+c1}{\PYZsh{} textFM = [\PYZsq{}+ on 2 planes\PYZsq{}, \PYZsq{}+ on 1 plane\PYZsq{}, \PYZsq{}\PYZhy{} on 2 planes\PYZsq{}]}
         
         \PY{c+c1}{\PYZsh{} ax[0].legend([im0, im2], textOOP, }
         \PY{c+c1}{\PYZsh{}              loc=\PYZsq{}upper center\PYZsq{}, bbox\PYZus{}to\PYZus{}anchor=(0.5, \PYZhy{}0.15))}
         \PY{c+c1}{\PYZsh{} ax[1].legend([im0, im1, im2], textFM,}
         \PY{c+c1}{\PYZsh{}              loc=\PYZsq{}upper center\PYZsq{}, bbox\PYZus{}to\PYZus{}anchor=(0.5, \PYZhy{}0.15))}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{n}{pad} \PY{o}{=} \PY{l+m+mf}{1.1}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:}
             \PY{n}{ax}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}yticklabels}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}:.0f\PYZcb{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{x}\PY{p}{)} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{get\PYZus{}yticks}\PY{p}{(}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{fig}\PY{p}{,} \PY{n}{axs} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{fig}\PY{o}{.}\PY{n}{set\PYZus{}size\PYZus{}inches}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:}
             \PY{n}{axs}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{.}\PY{n}{axis}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{off}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{textOOP} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{} \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Delta CFF\PYZdl{} on plane}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{+ \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Delta CFF\PYZdl{} on plane}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{textFM} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{} \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Delta CFF\PYZdl{} on 2 planes}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{+ \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Delta CFF\PYZdl{} on 1 plane}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{+ \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Delta CFF\PYZdl{} on 2 planes}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
         \PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{[}\PY{n}{im0}\PY{p}{,} \PY{n}{im2}\PY{p}{]}\PY{p}{,} \PY{n}{textOOP}\PY{p}{,} 
                      \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.15}\PY{p}{)}\PY{p}{)}
         \PY{n}{axs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{[}\PY{n}{im0}\PY{p}{,} \PY{n}{im1}\PY{p}{,} \PY{n}{im2}\PY{p}{]}\PY{p}{,} \PY{n}{textFM}\PY{p}{,}
                      \PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper center}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mf}{0.15}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_104_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_104_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    Figure 10 shows the percent of events with positive ∆CFF at different
time intervals. This overlays the magnitude of aftershocks through time.
After the mainshock, the frequency of events and their magnitudes
generally decreases through time until shortly after the MW 4.4
Campotosto earthquake in June. Near August-September, the percent of
events experiencing positive ∆CFF increases again. These effects are
amplified when the percent of events experiencing positive ∆CFF is
weighted by 10M.

    \paragraph{Figure 10}\label{figure-10}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}57}]:} \PY{c+c1}{\PYZsh{} Figure 10}
         \PY{n}{intervals} \PY{o}{=} \PY{l+m+mi}{9} 
         \PY{n}{timeSub} \PY{o}{=} \PY{n}{allPoints}\PY{o}{.}\PY{n}{time}\PY{p}{[}\PY{n}{allPoints}\PY{o}{.}\PY{n}{st1}\PY{o}{!=}\PY{l+m+mi}{0}\PY{p}{]} \PY{c+c1}{\PYZsh{} only where focal mechanisms available}
         
         \PY{n}{dcscomb2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}
             \PY{p}{[}\PY{n}{dCS1cir}\PY{p}{,}   \PY{n}{dCS2cir}\PY{p}{]}\PY{p}{,}  
             \PY{p}{[}\PY{n}{dCS1Heter}\PY{p}{,} \PY{n}{dCS2Heter}\PY{p}{]}\PY{p}{,}
             \PY{p}{[}\PY{n}{dCS1surf}\PY{p}{,}  \PY{n}{dCS2surf}\PY{p}{]}
         \PY{p}{]}\PY{p}{)}
         
         \PY{n}{titlesCenter} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Planar Joint}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Planar GPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{3D GPS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{fig}\PY{p}{,} \PY{n}{axes} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{nrows}\PY{o}{=}\PY{n}{dcscomb2}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{ncols}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{14}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{matplotlib}\PY{o}{.}\PY{n}{rcParams}\PY{o}{.}\PY{n}{update}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{font.size}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{11}\PY{p}{\PYZcb{}}\PY{p}{)}
         
         \PY{n}{timeMin} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{amin}\PY{p}{(}\PY{n}{timeSub}\PY{p}{)}
         \PY{n}{timeMax} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{amax}\PY{p}{(}\PY{n}{timeSub}\PY{p}{)}
         \PY{n}{dTime} \PY{o}{=} \PY{p}{(}\PY{n}{timeMax}\PY{o}{\PYZhy{}}\PY{n}{timeMin}\PY{p}{)}\PY{o}{/}\PY{n}{intervals}
         \PY{n}{timeSlices} \PY{o}{=} \PY{n}{timeMin} \PY{o}{+} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{intervals}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)} \PY{o}{*} \PY{n}{dTime}
         \PY{n}{timeSlicesPlot} \PY{o}{=} \PY{n}{timeSlices}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{+} \PY{o}{.}\PY{l+m+mi}{5} \PY{o}{*} \PY{n}{dTime}
         
         \PY{n}{p0} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{intervals}\PY{p}{)}
         \PY{n}{p1} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{intervals}\PY{p}{)}
         \PY{n}{p2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{n}{intervals}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{row} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{dcscomb2}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{n}{stress1} \PY{o}{=} \PY{n}{dcscomb2}\PY{p}{[}\PY{n}{row}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}
             \PY{n}{stress2} \PY{o}{=} \PY{n}{dcscomb2}\PY{p}{[}\PY{n}{row}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}
             
             \PY{k}{for} \PY{n}{w} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:}
             
                 \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{n}{intervals}\PY{p}{)}\PY{p}{:}
                     \PY{n}{timeBool} \PY{o}{=} \PY{p}{(}\PY{n}{timeSub} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{timeSlices}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)} \PY{o}{*} \PY{p}{(}\PY{n}{timeSub} \PY{o}{\PYZlt{}}\PY{o}{=} \PY{n}{timeSlices}\PY{p}{[}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
                     \PY{n}{timeBool} \PY{o}{=} \PY{n}{timeBool} \PY{o}{*} \PY{n}{includeAll}
                     
                     \PY{k}{if} \PY{n}{w} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                         \PY{n}{weights} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{allPoints}\PY{o}{.}\PY{n}{st1}\PY{o}{!=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
                     \PY{k}{elif} \PY{n}{w} \PY{o}{==} \PY{l+m+mi}{1}\PY{p}{:}
                         \PY{n}{weights} \PY{o}{=} \PY{l+m+mi}{10}\PY{o}{*}\PY{o}{*}\PY{n}{allPoints}\PY{o}{.}\PY{n}{mL}\PY{p}{[}\PY{n}{allPoints}\PY{o}{.}\PY{n}{st1}\PY{o}{!=}\PY{l+m+mi}{0}\PY{p}{]}
                     
                     \PY{n}{p0}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{p1}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,} \PY{n}{p2}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{p012}\PY{p}{(}\PY{n}{stress1}\PY{p}{,} \PY{n}{stress2}\PY{p}{,} \PY{n}{timeBool}\PY{p}{,}
                                                \PY{n}{weights} \PY{o}{=} \PY{n}{weights}\PY{p}{)}
         
                 \PY{n}{axes}\PY{p}{[}\PY{n}{row}\PY{p}{,}\PY{n}{w}\PY{p}{]}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{allPoints}\PY{o}{.}\PY{n}{time}\PY{p}{,} \PY{n}{allPoints}\PY{o}{.}\PY{n}{mL} \PY{p}{,}\PY{c+c1}{\PYZsh{}}
                             \PY{n}{s} \PY{o}{=} \PY{l+m+mf}{3.5}\PY{p}{,} \PY{n}{linewidths}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{02}\PY{p}{,} \PY{n}{edgecolors} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 \PY{n}{axes}\PY{p}{[}\PY{n}{row}\PY{p}{,}\PY{n}{w}\PY{p}{]}\PY{o}{.}\PY{n}{scatter}\PY{p}{(}\PY{n}{timeMin}\PY{p}{,} \PY{l+m+mi}{0}\PY{p}{,} \PY{n}{s} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}
                 
                 \PY{n}{ax2} \PY{o}{=} \PY{n}{axes}\PY{p}{[}\PY{n}{row}\PY{p}{,}\PY{n}{w}\PY{p}{]}\PY{o}{.}\PY{n}{twinx}\PY{p}{(}\PY{p}{)}
                 \PY{n}{ax2}\PY{o}{.}\PY{n}{plot}\PY{p}{(}   \PY{n}{timeSlicesPlot}\PY{p}{,} \PY{n}{p0}\PY{o}{+}\PY{n}{p1}\PY{o}{+}\PY{n}{p2}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{blue}\PY{l+s+s1}{\PYZsq{}}   \PY{p}{)} \PY{c+c1}{\PYZsh{} had to subtract one due to clipping}
                 \PY{n}{ax2}\PY{o}{.}\PY{n}{plot}\PY{p}{(}   \PY{n}{timeSlicesPlot}\PY{p}{,} \PY{n}{p1}\PY{o}{+}\PY{n}{p2}    \PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yellow}\PY{l+s+s1}{\PYZsq{}} \PY{p}{)}
                 \PY{n}{ax2}\PY{o}{.}\PY{n}{plot}\PY{p}{(}   \PY{n}{timeSlicesPlot}\PY{p}{,} \PY{n}{p2}       \PY{p}{,} \PY{n}{c} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}    \PY{p}{)}
                 \PY{n}{ax2}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)}
         
                 \PY{k}{if} \PY{n}{w} \PY{o}{==} \PY{l+m+mi}{0}\PY{p}{:}
                     \PY{n}{axes}\PY{p}{[}\PY{n}{row}\PY{p}{,}\PY{n}{w}\PY{p}{]}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{n}{titlesCenter}\PY{p}{[}\PY{n}{row}\PY{p}{]}\PY{p}{)}
                     
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}M\PYZus{}}\PY{l+s+si}{\PYZob{}L\PYZcb{}}\PY{l+s+s1}{\PYZdl{} and Positive \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{Delta\PYZdl{}CFF}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{fig}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{n}{rect}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mf}{0.03}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mf}{0.95}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_107_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
